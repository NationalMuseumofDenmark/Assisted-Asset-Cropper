/**
 * CIP.js, NatMus.js, qwest, underscore.js
 *
 * https://github.com/NationalMuseumofDenmark
 */
var qwest=function(){var a=window,d=null,h=0,g=[],l=function(){return a.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},m=""===l().responseType,s=function(z,C,v,x,E){v=v||null;x=x||{};var F=!1,n=l(),y=void 0===x.async?!0:!!x.async,A=!!x.cache,t=x.type?x.type.toLowerCase():"json",G=x.user||"",H=x.password||"",u={"X-Requested-With":"XMLHttpRequest"},p="",e,B,r=[],c=[],f=[],k,K,I,D,J={success:function(c){return y?r.push(c):K&&c.apply(n,[k]),J},error:function(f){return y?c.push(f):
I&&f.apply(n,[k]),J},complete:function(c){return y?f.push(c):c.apply(n),J}},q={success:function(c){return g[g.length-1].success.push(c),q},error:function(c){return g[g.length-1].error.push(c),q},complete:function(c){return g[g.length-1].complete.push(c),q}},L=function(){var d,e,l;--h;if(g.length){e=g.shift();l=s(e.method,e.url,e.data,e.options,e.before);for(d=0;D=e.success[d];++d)l.success(D);for(d=0;D=e.error[d];++d)l.error(D);for(d=0;D=e.complete[d];++d)l.complete(D)}try{if(200!=n.status)throw n.status+
" ("+n.statusText+")";if("text"==t||"html"==t)k=n.responseText;else if(F&&void 0!==n.response)k=n.response;else switch(t){case "json":try{a.JSON?k=a.JSON.parse(n.responseText):k=eval("("+n.responseText+")")}catch(q){throw"Error while parsing JSON body";}break;case "js":k=eval(n.responseText);break;case "xml":if(!n.responseXML||n.responseXML.parseError&&n.responseXML.parseError.errorCode&&n.responseXML.parseError.reason)throw"Error while parsing XML body";k=n.responseXML;break;default:throw"Unsupported "+
t+" type";}K=!0;if(y)for(d=0;D=r[d];++d)D.apply(n,[k])}catch(m){if(I=!0,k="Request to '"+C+"' aborted: "+m,y)for(d=0;D=c[d];++d)D.apply(n,[k])}if(y)for(d=0;D=f[d];++d)D.apply(n)};if(d&&h==d)return g.push({method:z,url:C,data:v,options:x,before:E,success:[],error:[],complete:[]}),q;++h;if(a.ArrayBuffer&&(v instanceof ArrayBuffer||v instanceof Blob||v instanceof Document||v instanceof FormData))"GET"==z&&(v=null);else{x=[];B=encodeURIComponent;for(e in v)x.push(B(e)+(v[e].pop?"[]":"")+"="+B(v[e]));
v=x.join("&");B=!0}"GET"==z&&(p+=v);A||(p&&(p+="&"),p+="t="+Date.now());p&&(C+=(/\?/.test(C)?"&":"?")+p);n.open(z,C,y,G,H);if(t&&m)try{n.responseType=t,F=n.responseType==t}catch(P){}m?n.onload=L:n.onreadystatechange=function(){4==n.readyState&&L()};B&&"POST"==z&&(u["Content-Type"]="application/x-www-form-urlencoded");u.Accept={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}[t];for(e in u)n.setRequestHeader(e,
u[e]);return E&&E.apply(n),n.send("POST"==z?v:null),J};return{get:function(d,a,g,h){return s("GET",d,a,g,h)},post:function(d,a,g,h){return s("POST",d,a,g,h)},xhr2:m,limit:function(a){d=a}}}();"undefined"==typeof window&&(window={});window.console=window.console||{log:function(){},error:function(){},warn:function(){},trace:function(){}};function assert(a,d){if(!a)throw d||"Assertion failed.";}"undefined"!=typeof exports?exports.assert=assert:window.cip_common={assert:assert};"undefined"!=typeof require&&(cip_table=require("./cip-table.js"),cip_common=require("./cip-common.js"));
function CIPCatalog(a,d){this.cip=a;for(var h in d)this[h]=d[h];void 0===this.alias&&(this.alias=a.config.catalog_aliases[this.name]);this.get_tables=function(d){cip_common.assert(this.cip.is_connected());var h=[],m=this;this.cip.ciprequest("metadata/gettables/"+a.config.constants.catch_all_alias,{catalogname:this.name},function(a,z){for(var C=0;C<a.tables.length;C++)h.push(new cip_table.CIPTable(this,m,a.tables[C]));d(h)})};this.get_categories=function(d,a,h){cip_common.assert(this.cip.is_connected());
this.cip.ciprequest("metadata/getcategories/"+this.alias+"/categories",{categoryid:d,levels:a},function(d,a){h(d)})}}"undefined"!=typeof exports?exports.CIPCatalog=CIPCatalog:window.cip_catalog={CIPCatalog:CIPCatalog};"undefined"!=typeof require&&(cip_common=require("./cip-common.js"),cip_layout=require("./cip-layout.js"));
function CIPTable(a,d,h){this.cip=a;this.catalog=d;this.name=h;this.layout=null;this.get_layout=function(d){cip_common.assert(this.cip.is_connected());var a=this.cip,h=["metadata/getlayout",this.catalog.alias,this.cip.config.constants.layout_alias].join("/");this.cip.ciprequest(h,{table:this.name},function(h){this.layout=h;d(new cip_layout.CIPLayout(a,this.layout.fields))})};this.search=function(d,a){this.cip.search(this,d,a)};this.criteriasearch=function(d,a){this.cip.criteriasearch(this,d,a)}}
"undefined"!=typeof exports?exports.CIPTable=CIPTable:window.cip_table={CIPTable:CIPTable};function CIPAsset(a,d,h){this.cip=a;this.fields=d;this.get_field_value=function(d){};this.get_fields=function(){};this.get_asset_url=function(d){var a={};void 0!==d&&(a.version=d);return this.cip.generate_url("asset/download/"+h.alias+"/"+this.fields.id,a)};this.get_versions=function(d){this.cip.ciprequest("asset/getversions/"+h.alias+"/"+this.fields.id,{},function(a){d(a.versions)})};this.get_image_url=function(d){return this.cip.generate_url("preview/image/"+h.alias+"/"+this.fields.id,d)};this.get_thumbnail_url=
function(d){var a={},m=["size","maxsize","rotate","format","quality"];void 0===d&&(d={});for(var s in m)void 0!==d[m[s]]&&(a[m[s]]="format"!==m[s]?parseInt(d[m[s]]):d[m[s]]);return this.cip.generate_url("preview/thumbnail/"+h.alias+"/"+this.fields.id,a)};this.get_related_assets=function(d,a){return this.cip.ciprequest(["metadata","getrelatedassets",h.alias,this.fields.id,d],{},a)}}"undefined"!=typeof exports?exports.CIPAsset=CIPAsset:window.cip_asset={CIPAsset:CIPAsset};"undefined"!=typeof require&&(cip_asset=require("./cip-asset.js"));function CIPSearchResult(a,d,h){this.cip=a;this.total_rows=d.totalcount;this.collection_id=d.collection;this.catalog=h;this.get=function(d,a,m){var s=[];void 0===d&&(d=100);this.cip.ciprequest("metadata/getfieldvalues/web",{collection:this.collection_id,startindex:a,maxreturned:d},function(d){for(var a=0;a<d.items.length;a++)s.push(new cip_asset.CIPAsset(this,d.items[a],h));m(s)})}}
"undefined"!=typeof exports?exports.CIPSearchResult=CIPSearchResult:window.cip_searchresult={CIPSearchResult:CIPSearchResult};function CIPLayout(a,d){this.cip=a;this.fields=d;this.cache={};this.lookup_field=function(a){if(void 0!==this.cache[a])return this.cache[a];for(var g=0;g<d.length;g++)if(this.fields[g].key===a)return this.cache[a]=this.fields[g],this.fields[g]}}"undefined"!=typeof exports?exports.CIPLayout=CIPLayout:window.cip_layout={CIPLayout:CIPLayout};"undefined"!=typeof require&&(request=require("request"),cip_catalog=require("./cip-catalog.js"),cip_searchresult=require("./cip-searchresult.js"),cip_common=require("./cip-common.js"));
function CIPClient(a){this.config=a;this.jsessionid=null;this.DEBUG=!0;cip_common.assert(void 0!==a,"The CIPClient must be passed a config object.");cip_common.assert(void 0!==a.endpoint,"The config must have an endpoint property.");this.cache={catalogs:null};this.default_named_parameters={apiversion:4,serveraddress:"localhost"};this.named_parameters_with_defaults=function(d){var a={},g;for(g in this.default_named_parameters)a[g]=this.default_named_parameters[g];if("undefined"===typeof d||null===
d)d={};else if("object"!==typeof d)throw"The named_parameters parameter must be an object, undefined or null.";for(g in d)a[g]=d[g];return a};this.generate_url=function(d,a,g){d=this.config.endpoint+d;var l="";!0!==g&&this.jsessionid&&(d+=";jsessionid="+this.jsessionid);a=!1!==a?this.named_parameters_with_defaults(a):{};for(var m in a)0<l.length&&(l+="&"),l+=m+"="+a[m];0<l.length&&(d+="?"+l);return d};this.ciprequest=function(a,h,g,l,m){"object"===typeof a&&(a=a.join("/"));void 0===m&&(m=!1);null===
this.jsessionid&&"session/open"!==a&&console.warn("No jsessionid - consider calling session_open before calling other action.");g="function"===typeof g?g.bind(this):function(a){console.warn("Unhandled success from the CIP - consider adding a success callback function the ciprequest call.");console.log(a)};"function"!==typeof l&&(l=function(a){console.warn("Unhandled error from the CIP - consider adding an error callback function the ciprequest call.");console.error("An error occured when communicating with the CIP.",
a);console.trace()});h=this.named_parameters_with_defaults(h);a=this.generate_url(a,!1);if("undefined"!=typeof require&&request)return request.post({url:a,method:"POST",form:h},function(a,d,h){a||200!=d.statusCode?l(d):""===d.body?g(!0):g(JSON.parse(d.body))});if(qwest&&"object"===typeof qwest)return qwest.post(a,h,{async:m}).success(g).error(l)};this.session_open=function(a,h,g,l){var m=this;this.ciprequest("session/open",{user:a,password:h},function(a){if(a.jsessionid)m.jsessionid=a.jsessionid,
console.log("Connected to CIP: "+m.jsessionid),g(a);else{debugger;console.log("SessionID is missing!")}},function(a){l&&l(a)||console.error("Could not make request to CIP.")},!0)};this.session_close=function(){this.ciprequest("session/close",{})};this.is_connected=function(){return null!==this.jsessionid};this.get_catalogs=function(a,h){cip_common.assert(this.is_connected());null!==this.cache.catalogs&&a(this.cache.catalogs);this.ciprequest("metadata/getcatalogs",{},function(g){this.cache.catalogs=
[];for(var h=this.config.catalog_aliases,m=0;m<g.catalogs.length;m++)if(g.catalogs[m].name in h){var s=new cip_catalog.CIPCatalog(this,g.catalogs[m]);this.cache.catalogs.push(s)}a(this.cache.catalogs)},h)};this.search=function(a,h,g,l){return this.advancedsearch(a,void 0,h,void 0,g,l)};this.criteriasearch=function(a,h,g,l,m){return this.advancedsearch(a,h,void 0,g,l,m)};this.advancedsearch=function(a,h,g,l,m,s){cip_common.assert(this.is_connected());cip_common.assert(void 0!==a.catalog.alias,"Catalog must have an alias.");
cip_common.assert(void 0!==h||void 0!==g,"Either querystring or searchterm must be defined.");this.ciprequest(["metadata","search",a.catalog.alias],{querystring:h,quicksearchstring:g,sortby:l,table:a.name,collection:""},function(g){m(new cip_searchresult.CIPSearchResult(this,g,a.catalog))},s)};this.get_asset=function(a,h,g,l,m){a=this.get_table(a);cip_common.assert(void 0!==h,"The asset_id must have a value.");!0===g?this.criteriasearch(a,"id == "+h,null,function(a){a.get(1,0,function(a){1!==a.length?
(console.warn("The criteriasearch didn't return exactly one result. Check parameters."),m(a)):l(a[0])})},m):(h=new cip_asset.CIPAsset(this,{id:h},a.catalog),l(h))};this.get_table=function(a,h){cip_common.assert(void 0!==a,"Catalog must have an alias.");"undefined"==typeof h&&(h="AssetRecords");var g=new cip_catalog.CIPCatalog(this,{alias:a});return new cip_table.CIPTable(this,g,h)};this.get_version=function(a,h){cip_common.assert("function"===typeof a,"The callback must be a function.");this.ciprequest("system/getversion",
{},function(g){a(g.version)},h)}}"undefined"!=typeof exports&&(exports.CIPClient=CIPClient);var Zepto=function(){function a(b){return null==b?String(b):Q[W.call(b)]||"object"}function d(b){return"function"==a(b)}function h(b){return null!=b&&b==b.window}function g(b){return null!=b&&b.nodeType==b.DOCUMENT_NODE}function l(b){return"object"==a(b)}function m(b){return l(b)&&!h(b)&&Object.getPrototypeOf(b)==Object.prototype}function s(b){return b instanceof Array}function z(b){return"number"==typeof b.length}function C(b){return f.call(b,function(b){return null!=b})}function v(b){return b.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function x(b){return b in I?I[b]:I[b]=RegExp("(^|\\s)"+b+"(\\s|$)")}function E(b,a){return"number"!=typeof a||D[v(b)]?a:a+"px"}function F(b){return"children"in b?c.call(b.children):e.map(b.childNodes,function(b){if(1==b.nodeType)return b})}function n(b,a,c){for(p in a)c&&(m(a[p])||s(a[p]))?(m(a[p])&&!m(b[p])&&(b[p]={}),s(a[p])&&!s(b[p])&&(b[p]=[]),n(b[p],a[p],c)):a[p]!==u&&(b[p]=a[p])}
function y(b,a){return null==a?e(b):e(b).filter(a)}function A(b,a,c,f){return d(a)?a.call(b,c,f):a}function t(b,a){var c=b.className,f=c&&c.baseVal!==u;if(a===u)return f?c.baseVal:c;f?c.baseVal=a:b.className=a}function G(b){var a;try{return b?"true"==b||("false"==b?!1:"null"==b?null:/^0/.test(b)||isNaN(a=Number(b))?/^[\[\{]/.test(b)?e.parseJSON(b):b:a):b}catch(c){return b}}function H(b,a){a(b);for(var c in b.childNodes)H(b.childNodes[c],a)}var u,p,e,B,r=[],c=r.slice,f=r.filter,k=window.document,K=
{},I={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},J=/^\s*<(\w+|!)[^>]*>/,q=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,L=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,P=/^(?:body|html)$/i,U=/([A-Z])/g,V="val css html text data width height offset".split(" "),O=k.createElement("table"),R=k.createElement("tr"),S={tr:k.createElement("tbody"),tbody:O,thead:O,tfoot:O,td:R,th:R,"*":k.createElement("div")},X=/complete|loaded|interactive/,Y=/^[\w-]*$/,
Q={},W=Q.toString,w={},M,N,T=k.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};return w.matches=function(b,a){if(!a||!b||1!==b.nodeType)return!1;var c=b.webkitMatchesSelector||b.mozMatchesSelector||b.oMatchesSelector||b.matchesSelector;if(c)return c.call(b,a);var f,
c=b.parentNode,d=!c;return d&&(c=T).appendChild(b),f=~w.qsa(c,a).indexOf(b),d&&T.removeChild(b),f},M=function(b){return b.replace(/-+(.)?/g,function(b,a){return a?a.toUpperCase():""})},N=function(b){return f.call(b,function(a,c){return b.indexOf(a)==c})},w.fragment=function(b,a,f){var d,r,g;return q.test(b)&&(d=e(k.createElement(RegExp.$1))),d||(b.replace&&(b=b.replace(L,"<$1></$2>")),a===u&&(a=J.test(b)&&RegExp.$1),a in S||(a="*"),g=S[a],g.innerHTML=""+b,d=e.each(c.call(g.childNodes),function(){g.removeChild(this)})),
m(f)&&(r=e(d),e.each(f,function(b,a){-1<V.indexOf(b)?r[b](a):r.attr(b,a)})),d},w.Z=function(b,a){return b=b||[],b.__proto__=e.fn,b.selector=a||"",b},w.isZ=function(b){return b instanceof w.Z},w.init=function(b,a){var c;if(!b)return w.Z();if("string"==typeof b)if(b=b.trim(),"<"==b[0]&&J.test(b))c=w.fragment(b,RegExp.$1,a),b=null;else{if(a!==u)return e(a).find(b);c=w.qsa(k,b)}else{if(d(b))return e(k).ready(b);if(w.isZ(b))return b;if(s(b))c=C(b);else if(l(b))c=[b],b=null;else if(J.test(b))c=w.fragment(b.trim(),
RegExp.$1,a),b=null;else{if(a!==u)return e(a).find(b);c=w.qsa(k,b)}}return w.Z(c,b)},e=function(b,a){return w.init(b,a)},e.extend=function(b){var a,f=c.call(arguments,1);return"boolean"==typeof b&&(a=b,b=f.shift()),f.forEach(function(c){n(b,c,a)}),b},w.qsa=function(b,a){var f,d="#"==a[0],r=!d&&"."==a[0],k=d||r?a.slice(1):a,e=Y.test(k);return g(b)&&e&&d?(f=b.getElementById(k))?[f]:[]:1!==b.nodeType&&9!==b.nodeType?[]:c.call(e&&!d?r?b.getElementsByClassName(k):b.getElementsByTagName(a):b.querySelectorAll(a))},
e.contains=function(b,a){return b!==a&&b.contains(a)},e.type=a,e.isFunction=d,e.isWindow=h,e.isArray=s,e.isPlainObject=m,e.isEmptyObject=function(b){for(var a in b)return!1;return!0},e.inArray=function(b,a,c){return r.indexOf.call(a,b,c)},e.camelCase=M,e.trim=function(b){return null==b?"":String.prototype.trim.call(b)},e.uuid=0,e.support={},e.expr={},e.map=function(b,a){var c,f=[],d;if(z(b))for(d=0;d<b.length;d++)c=a(b[d],d),null!=c&&f.push(c);else for(d in b)c=a(b[d],d),null!=c&&f.push(c);return 0<
f.length?e.fn.concat.apply([],f):f},e.each=function(b,a){var c;if(z(b))for(c=0;c<b.length&&!1!==a.call(b[c],c,b[c]);c++);else for(c in b)if(!1===a.call(b[c],c,b[c]))break;return b},e.grep=function(b,a){return f.call(b,a)},window.JSON&&(e.parseJSON=JSON.parse),e.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b,a){Q["[object "+a+"]"]=a.toLowerCase()}),e.fn={forEach:r.forEach,reduce:r.reduce,push:r.push,sort:r.sort,indexOf:r.indexOf,concat:r.concat,map:function(b){return e(e.map(this,
function(a,c){return b.call(a,c,a)}))},slice:function(){return e(c.apply(this,arguments))},ready:function(b){return X.test(k.readyState)&&k.body?b(e):k.addEventListener("DOMContentLoaded",function(){b(e)},!1),this},get:function(b){return b===u?c.call(this):this[0<=b?b:b+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(b){return r.every.call(this,
function(a,c){return!1!==b.call(a,c,a)}),this},filter:function(b){return d(b)?this.not(this.not(b)):e(f.call(this,function(a){return w.matches(a,b)}))},add:function(b,a){return e(N(this.concat(e(b,a))))},is:function(b){return 0<this.length&&w.matches(this[0],b)},not:function(b){var a=[];if(d(b)&&b.call!==u)this.each(function(c){b.call(this,c)||a.push(this)});else{var f="string"==typeof b?this.filter(b):z(b)&&d(b.item)?c.call(b):e(b);this.forEach(function(b){0>f.indexOf(b)&&a.push(b)})}return e(a)},
has:function(b){return this.filter(function(){return l(b)?e.contains(this,b):e(this).find(b).size()})},eq:function(b){return-1===b?this.slice(b):this.slice(b,+b+1)},first:function(){var b=this[0];return b&&!l(b)?b:e(b)},last:function(){var b=this[this.length-1];return b&&!l(b)?b:e(b)},find:function(b){var a,c=this;return"object"==typeof b?a=e(b).filter(function(){var b=this;return r.some.call(c,function(a){return e.contains(a,b)})}):1==this.length?a=e(w.qsa(this[0],b)):a=this.map(function(){return w.qsa(this,
b)}),a},closest:function(b,a){var c=this[0],f=!1;for("object"==typeof b&&(f=e(b));c&&!(f?0<=f.indexOf(c):w.matches(c,b));)c=c!==a&&!g(c)&&c.parentNode;return e(c)},parents:function(b){for(var a=[],c=this;0<c.length;)c=e.map(c,function(b){if((b=b.parentNode)&&!g(b)&&0>a.indexOf(b))return a.push(b),b});return y(a,b)},parent:function(b){return y(N(this.pluck("parentNode")),b)},children:function(b){return y(this.map(function(){return F(this)}),b)},contents:function(){return this.map(function(){return c.call(this.childNodes)})},
siblings:function(b){return y(this.map(function(b,a){return f.call(F(a.parentNode),function(b){return b!==a})}),b)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(b){return e.map(this,function(a){return a[b]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display="");if("none"==getComputedStyle(this,"").getPropertyValue("display")){var b=this.style,a;a=this.nodeName;var c,f;a=(K[a]||(c=k.createElement(a),k.body.appendChild(c),
f=getComputedStyle(c,"").getPropertyValue("display"),c.parentNode.removeChild(c),"none"==f&&(f="block"),K[a]=f),K[a]);b.display=a}})},replaceWith:function(b){return this.before(b).remove()},wrap:function(b){var a=d(b);if(this[0]&&!a)var c=e(b).get(0),f=c.parentNode||1<this.length;return this.each(function(d){e(this).wrapAll(a?b.call(this,d):f?c.cloneNode(!0):c)})},wrapAll:function(b){if(this[0]){e(this[0]).before(b=e(b));for(var a;(a=b.children()).length;)b=a.first();e(b).append(this)}return this},
wrapInner:function(b){var a=d(b);return this.each(function(c){var f=e(this),d=f.contents();c=a?b.call(this,c):b;d.length?d.wrapAll(c):f.append(c)})},unwrap:function(){return this.parent().each(function(){e(this).replaceWith(e(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(b){return this.each(function(){var a=e(this);(b===u?"none"==a.css("display"):b)?a.show():a.hide()})},prev:function(b){return e(this.pluck("previousElementSibling")).filter(b||
"*")},next:function(b){return e(this.pluck("nextElementSibling")).filter(b||"*")},html:function(b){return 0===arguments.length?0<this.length?this[0].innerHTML:null:this.each(function(a){var c=this.innerHTML;e(this).empty().append(A(this,b,a,c))})},text:function(b){return 0===arguments.length?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=b===u?"":""+b})},attr:function(b,a){var c;return"string"==typeof b&&a===u?0==this.length||1!==this[0].nodeType?u:"value"==b&&"INPUT"==
this[0].nodeName?this.val():!(c=this[0].getAttribute(b))&&b in this[0]?this[0][b]:c:this.each(function(c){if(1===this.nodeType)if(l(b))for(p in b){c=p;var f=b[p];null==f?this.removeAttribute(c):this.setAttribute(c,f)}else c=A(this,a,c,this.getAttribute(b)),null==c?this.removeAttribute(b):this.setAttribute(b,c)})},removeAttr:function(b){return this.each(function(){1===this.nodeType&&this.removeAttribute(b)})},prop:function(b,a){return b=Z[b]||b,a===u?this[0]&&this[0][b]:this.each(function(c){this[b]=
A(this,a,c,this[b])})},data:function(b,a){var c=this.attr("data-"+b.replace(U,"-$1").toLowerCase(),a);return null!==c?G(c):u},val:function(b){return 0===arguments.length?this[0]&&(this[0].multiple?e(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(a){this.value=A(this,b,a,this.value)})},offset:function(b){if(b)return this.each(function(a){var c=e(this);a=A(this,b,a,c.offset());var f=c.offsetParent().offset();a={top:a.top-f.top,left:a.left-
f.left};"static"==c.css("position")&&(a.position="relative");c.css(a)});if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:Math.round(a.width),height:Math.round(a.height)}},css:function(b,c){if(2>arguments.length){var f=this[0],d=getComputedStyle(f,"");if(!f)return;if("string"==typeof b)return f.style[M(b)]||d.getPropertyValue(b);if(s(b)){var r={};return e.each(s(b)?b:[b],function(b,a){r[a]=f.style[M(a)]||d.getPropertyValue(a)}),
r}}var k="";if("string"==a(b))c||0===c?k=v(b)+":"+E(b,c):this.each(function(){this.style.removeProperty(v(b))});else for(p in b)b[p]||0===b[p]?k+=v(p)+":"+E(p,b[p])+";":this.each(function(){this.style.removeProperty(v(p))});return this.each(function(){this.style.cssText+=";"+k})},index:function(a){return a?this.indexOf(e(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return a?r.some.call(this,function(a){return this.test(t(a))},x(a)):!1},addClass:function(a){return a?this.each(function(c){B=
[];var f=t(this);A(this,a,c,f).split(/\s+/g).forEach(function(a){e(this).hasClass(a)||B.push(a)},this);B.length&&t(this,f+(f?" ":"")+B.join(" "))}):this},removeClass:function(a){return this.each(function(c){if(a===u)return t(this,"");B=t(this);A(this,a,c,B).split(/\s+/g).forEach(function(a){B=B.replace(x(a)," ")});t(this,B.trim())})},toggleClass:function(a,c){return a?this.each(function(f){var d=e(this);A(this,a,f,t(this)).split(/\s+/g).forEach(function(a){(c===u?!d.hasClass(a):c)?d.addClass(a):d.removeClass(a)})}):
this},scrollTop:function(a){if(this.length){var c="scrollTop"in this[0];return a===u?c?this[0].scrollTop:this[0].pageYOffset:this.each(c?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,a)})}},scrollLeft:function(a){if(this.length){var c="scrollLeft"in this[0];return a===u?c?this[0].scrollLeft:this[0].pageXOffset:this.each(c?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],c=this.offsetParent(),f=this.offset(),
d=P.test(c[0].nodeName)?{top:0,left:0}:c.offset();return f.top-=parseFloat(e(a).css("margin-top"))||0,f.left-=parseFloat(e(a).css("margin-left"))||0,d.top+=parseFloat(e(c[0]).css("border-top-width"))||0,d.left+=parseFloat(e(c[0]).css("border-left-width"))||0,{top:f.top-d.top,left:f.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||k.body;a&&!P.test(a.nodeName)&&"static"==e(a).css("position");)a=a.offsetParent;return a})}},e.fn.detach=e.fn.remove,["width",
"height"].forEach(function(a){var c=a.replace(/./,function(a){return a[0].toUpperCase()});e.fn[a]=function(f){var d,k=this[0];return f===u?h(k)?k["inner"+c]:g(k)?k.documentElement["scroll"+c]:(d=this.offset())&&d[a]:this.each(function(c){k=e(this);k.css(a,A(this,f,c,k[a]()))})}}),["after","prepend","before","append"].forEach(function(b,c){var f=c%2;e.fn[b]=function(){var b,d=e.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:w.fragment(c)}),k,r=1<this.length;return 1>d.length?
this:this.each(function(a,b){k=f?b:b.parentNode;b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null;d.forEach(function(a){if(r)a=a.cloneNode(!0);else if(!k)return e(a).remove();H(k.insertBefore(a,b),function(a){null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src||window.eval.call(window,a.innerHTML)})})})};e.fn[f?b+"To":"insert"+(c?"Before":"After")]=function(a){return e(a)[b](this),this}}),w.Z.prototype=e.fn,w.uniq=N,w.deserializeValue=G,e.zepto=w,e}();
window.Zepto=Zepto;void 0===window.$&&(window.$=Zepto);
(function(a){function d(a){return a._zid||(a._zid=v++)}function h(a,c,f,k){c=g(c);if(c.ns)var e=RegExp("(?:^| )"+c.ns.replace(" "," .* ?")+"(?: |$)");return(y[d(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||e.test(a.ns))&&(!f||d(a.fn)===d(f))&&(!k||a.sel==k)})}function g(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function l(a){return H[a]||t&&G[a]||a}function m(e,c,f,k,h,I,m){var n=d(e),q=y[n]||(y[n]=[]);c.split(/\s/).forEach(function(c){if("ready"==c)return a(document).ready(f);
var d=g(c);d.fn=f;d.sel=h;d.e in H&&(f=function(c){var f=c.relatedTarget;if(!f||f!==this&&!a.contains(this,f))return d.fn.apply(this,arguments)});var n=(d.del=I)||f;d.proxy=function(a){a=z(a);if(!a.isImmediatePropagationStopped()){a.data=k;var c=n.apply(e,a._args==x?[a]:[a].concat(a._args));return!1===c&&(a.preventDefault(),a.stopPropagation()),c}};d.i=q.length;q.push(d);"addEventListener"in e&&e.addEventListener(l(d.e),d.proxy,d.del&&!t&&d.e in G||!!m)})}function s(a,c,f,k,e){var g=d(a);(c||"").split(/\s/).forEach(function(c){h(a,
c,f,k).forEach(function(c){delete y[g][c.i];"removeEventListener"in a&&a.removeEventListener(l(c.e),c.proxy,c.del&&!t&&c.e in G||!!e)})})}function z(d,c){if(c||!d.isDefaultPrevented)if(c||(c=d),a.each(B,function(a,k){var e=c[a];d[a]=function(){return this[k]=u,e&&e.apply(c,arguments)};d[k]=p}),c.defaultPrevented!==x?c.defaultPrevented:"returnValue"in c?!1===c.returnValue:c.getPreventDefault&&c.getPreventDefault())d.isDefaultPrevented=u;return d}function C(a){var c,f={originalEvent:a};for(c in a)!e.test(c)&&
a[c]!==x&&(f[c]=a[c]);return z(f,a)}var v=1,x,E=Array.prototype.slice,F=a.isFunction,n=function(a){return"string"==typeof a},y={},A={},t="onfocusin"in window,G={focus:"focusin",blur:"focusout"},H={mouseenter:"mouseover",mouseleave:"mouseout"};A.click=A.mousedown=A.mouseup=A.mousemove="MouseEvents";a.event={add:m,remove:s};a.proxy=function(e,c){if(F(e)){var f=function(){return e.apply(c,arguments)};return f._zid=d(e),f}if(n(c))return a.proxy(e[c],e);throw new TypeError("expected function");};a.fn.bind=
function(a,c,f){return this.on(a,c,f)};a.fn.unbind=function(a,c){return this.off(a,c)};a.fn.one=function(a,c,f,d){return this.on(a,c,f,d,1)};var u=function(){return!0},p=function(){return!1},e=/^([A-Z]|returnValue$|layer[XY]$)/,B={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,c,f){return this.on(c,a,f)};a.fn.undelegate=function(a,c,f){return this.off(c,a,f)};a.fn.live=function(d,c){return a(document.body).delegate(this.selector,
d,c),this};a.fn.die=function(d,c){return a(document.body).undelegate(this.selector,d,c),this};a.fn.on=function(d,c,f,k,e){var g,h,l=this;if(d&&!n(d))return a.each(d,function(a,d){l.on(a,c,f,d,e)}),l;!n(c)&&!F(k)&&!1!==k&&(k=f,f=c,c=x);if(F(f)||!1===f)k=f,f=x;return!1===k&&(k=p),l.each(function(q,l){e&&(g=function(a){return s(l,a.type,k),k.apply(this,arguments)});c&&(h=function(f){var d,e=a(f.target).closest(c,l).get(0);if(e&&e!==l)return d=a.extend(C(f),{currentTarget:e,liveFired:l}),(g||k).apply(e,
[d].concat(E.call(arguments,1)))});m(l,d,k,f,c,h||g)})};a.fn.off=function(d,c,f){var e=this;return d&&!n(d)?(a.each(d,function(a,f){e.off(a,c,f)}),e):(!n(c)&&!F(f)&&!1!==f&&(f=c,c=x),!1===f&&(f=p),e.each(function(){s(this,d,f,c)}))};a.fn.trigger=function(d,c){return d=n(d)||a.isPlainObject(d)?a.Event(d):z(d),d._args=c,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(d):a(this).triggerHandler(d,c)})};a.fn.triggerHandler=function(d,c){var f,e;return this.each(function(g,l){f=C(n(d)?a.Event(d):
d);f._args=c;f.target=l;a.each(h(l,d.type||d),function(a,c){e=c.proxy(f);if(f.isImmediatePropagationStopped())return!1})}),e};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(d){a.fn[d]=function(a){return a?this.bind(d,a):this.trigger(d)}});["focus","blur"].forEach(function(d){a.fn[d]=function(a){return a?this.bind(d,a):this.each(function(){try{this[d]()}catch(a){}}),
this}});a.Event=function(a,c){n(a)||(c=a,a=c.type);var d=document.createEvent(A[a]||"Events"),e=!0;if(c)for(var g in c)"bubbles"==g?e=!!c[g]:d[g]=c[g];return d.initEvent(a,e,!0),z(d)}})(Zepto);
(function(a){function d(c,d,e,g){if(c.global)return c=d||y,e=a.Event(e),a(c).trigger(e,g),!e.isDefaultPrevented()}function h(c){c.global&&0===a.active++&&d(c,null,"ajaxStart")}function g(a,f){var e=f.context;if(!1===f.beforeSend.call(e,a,f)||!1===d(f,e,"ajaxBeforeSend",[a,f]))return!1;d(f,e,"ajaxSend",[a,f])}function l(a,f,e,g){var h=e.context;e.success.call(h,a,"success",f);g&&g.resolveWith(h,[a,"success",f]);d(e,h,"ajaxSuccess",[f,e,a]);s("success",f,e)}function m(a,f,e,g,h){var l=g.context;g.error.call(l,
e,f,a);h&&h.rejectWith(l,[e,f,a]);d(g,l,"ajaxError",[e,g,a||f]);s(f,e,g)}function s(c,f,e){var g=e.context;e.complete.call(g,f,c);d(e,g,"ajaxComplete",[f,e]);e.global&&!--a.active&&d(e,null,"ajaxStop")}function z(){}function C(a){return a&&(a=a.split(";",2)[0]),a&&(a==e?"html":a==p?"json":H.test(a)?"script":u.test(a)&&"xml")||"text"}function v(a,d){return""==d?a:(a+"&"+d).replace(/[&?]{1,2}/,"?")}function x(c){c.processData&&c.data&&"string"!=a.type(c.data)&&(c.data=a.param(c.data,c.traditional));
c.data&&(!c.type||"GET"==c.type.toUpperCase())&&(c.url=v(c.url,c.data),c.data=void 0)}function E(c,d,e,g){var h=!a.isFunction(d);return{url:c,data:h?d:void 0,success:h?a.isFunction(e)?e:void 0:d,dataType:h?g||e:e}}function F(c,d,e,g){var h,l=a.isArray(d),m=a.isPlainObject(d);a.each(d,function(d,f){h=a.type(f);g&&(d=e?g:g+"["+(m||"object"==h||"array"==h?d:"")+"]");!g&&l?c.add(f.name,f.value):"array"==h||!e&&"object"==h?F(c,f,e,d):c.add(d,f)})}var n=0,y=window.document,A,t,G=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
H=/^(?:text|application)\/javascript/i,u=/^(?:text|application)\/xml/i,p="application/json",e="text/html",B=/^\s*$/;a.active=0;a.ajaxJSONP=function(c,d){if("type"in c){var e=c.jsonpCallback,h=(a.isFunction(e)?e():e)||"jsonp"+ ++n,p=y.createElement("script"),s=window[h],r,q=function(c){a(p).triggerHandler("error",c||"abort")},t={abort:q},u;return d&&d.promise(t),a(p).on("load error",function(e,g){clearTimeout(u);a(p).off().remove();"error"!=e.type&&r?l(r[0],t,c,d):m(null,g||"error",t,c,d);window[h]=
s;r&&a.isFunction(s)&&s(r[0]);s=r=void 0}),!1===g(t,c)?(q("abort"),t):(window[h]=function(){r=arguments},p.src=c.url.replace(/=\?/,"="+h),y.head.appendChild(p),0<c.timeout&&(u=setTimeout(function(){q("timeout")},c.timeout)),t)}return a.ajax(c)};a.ajaxSettings={type:"GET",beforeSend:z,success:z,error:z,complete:z,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:p,xml:"application/xml, text/xml",
html:e,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};a.ajax=function(c){var d=a.extend({},c||{}),e=a.Deferred&&a.Deferred();for(A in a.ajaxSettings)void 0===d[A]&&(d[A]=a.ajaxSettings[A]);h(d);d.crossDomain||(d.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(d.url)&&RegExp.$2!=window.location.host);d.url||(d.url=window.location.toString());x(d);!1===d.cache&&(d.url=v(d.url,"_="+Date.now()));var n=d.dataType;c=/=\?/.test(d.url);if("jsonp"==n||c)return c||(d.url=v(d.url,d.jsonp?d.jsonp+
"=?":!1===d.jsonp?"":"callback=?")),a.ajaxJSONP(d,e);c=d.accepts[n];var p={},r=function(a,c){p[a.toLowerCase()]=[a,c]},s=/^([\w-]+:)\/\//.test(d.url)?RegExp.$1:window.location.protocol,q=d.xhr(),u=q.setRequestHeader,y;e&&e.promise(q);d.crossDomain||r("X-Requested-With","XMLHttpRequest");r("Accept",c||"*/*");if(c=d.mimeType||c)-1<c.indexOf(",")&&(c=c.split(",",2)[0]),q.overrideMimeType&&q.overrideMimeType(c);(d.contentType||!1!==d.contentType&&d.data&&"GET"!=d.type.toUpperCase())&&r("Content-Type",
d.contentType||"application/x-www-form-urlencoded");if(d.headers)for(t in d.headers)r(t,d.headers[t]);q.setRequestHeader=r;q.onreadystatechange=function(){if(4==q.readyState){q.onreadystatechange=z;clearTimeout(y);var c,g=!1;if(200<=q.status&&300>q.status||304==q.status||0==q.status&&"file:"==s){n=n||C(d.mimeType||q.getResponseHeader("content-type"));c=q.responseText;try{"script"==n?(0,eval)(c):"xml"==n?c=q.responseXML:"json"==n&&(c=B.test(c)?null:a.parseJSON(c))}catch(h){g=h}g?m(g,"parsererror",
q,d,e):l(c,q,d,e)}else m(q.statusText||null,q.status?"error":"abort",q,d,e)}};if(!1===g(q,d))return q.abort(),m(null,"abort",q,d,e),q;if(d.xhrFields)for(t in d.xhrFields)q[t]=d.xhrFields[t];q.open(d.type,d.url,"async"in d?d.async:!0,d.username,d.password);for(t in p)u.apply(q,p[t]);return 0<d.timeout&&(y=setTimeout(function(){q.onreadystatechange=z;q.abort();m(null,"timeout",q,d,e)},d.timeout)),q.send(d.data?d.data:null),q};a.get=function(c,d,e,g){return a.ajax(E.apply(null,arguments))};a.post=function(c,
d,e,g){var h=E.apply(null,arguments);return h.type="POST",a.ajax(h)};a.getJSON=function(c,d,e){var g=E.apply(null,arguments);return g.dataType="json",a.ajax(g)};a.fn.load=function(c,d,e){if(!this.length)return this;var g=this,h=c.split(/\s/),l;c=E(c,d,e);var m=c.success;return 1<h.length&&(c.url=h[0],l=h[1]),c.success=function(c){g.html(l?a("<div>").html(c.replace(G,"")).find(l):c);m&&m.apply(g,arguments)},a.ajax(c),this};var r=encodeURIComponent;a.param=function(a,d){var e=[];return e.add=function(a,
c){this.push(r(a)+"="+r(c))},F(e,a,d),e.join("&").replace(/%20/g,"+")}})(Zepto);
(function(a){a.fn.serializeArray=function(){var d=[],h;return a([].slice.call(this.get(0).elements)).each(function(){h=a(this);var g=h.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=g&&"reset"!=g&&"button"!=g&&("radio"!=g&&"checkbox"!=g||this.checked)&&d.push({name:h.attr("name"),value:h.val()})}),d};a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(h){a.push(encodeURIComponent(h.name)+"="+encodeURIComponent(h.value))}),a.join("&")};
a.fn.submit=function(d){d?this.bind("submit",d):this.length&&(d=a.Event("submit"),this.eq(0).trigger(d),d.isDefaultPrevented()||this.get(0).submit());return this}})(Zepto);(function(a){"__proto__"in{}||a.extend(a.zepto,{Z:function(d,h){return d=d||[],a.extend(d,a.fn),d.selector=h||"",d.__Z=!0,d},isZ:function(d){return"array"===a.type(d)&&"__Z"in d}});try{getComputedStyle(void 0)}catch(d){var h=getComputedStyle;window.getComputedStyle=function(a){try{return h(a)}catch(d){return null}}}})(Zepto);
