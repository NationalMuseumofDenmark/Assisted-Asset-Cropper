/**
 * CIP.js, NatMus.js, qwest, underscore.js
 *
 * https://github.com/NationalMuseumofDenmark
 */
var qwest=function(){var a=window,d=null,g=0,h=[],k=function(){return a.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},n=""===k().responseType,u=function(z,C,v,x,E){v=v||null;x=x||{};var F=!1,m=k(),y=void 0===x.async?!0:!!x.async,A=!!x.cache,t=x.type?x.type.toLowerCase():"json",G=x.user||"",H=x.password||"",r={"X-Requested-With":"XMLHttpRequest"},p="",e,B,s=[],c=[],f=[],l,K,I,D,J={success:function(c){return y?s.push(c):K&&c.apply(m,[l]),J},error:function(f){return y?c.push(f):
I&&f.apply(m,[l]),J},complete:function(c){return y?f.push(c):c.apply(m),J}},q={success:function(c){return h[h.length-1].success.push(c),q},error:function(c){return h[h.length-1].error.push(c),q},complete:function(c){return h[h.length-1].complete.push(c),q}},L=function(){var d,e,k;--g;if(h.length){e=h.shift();k=u(e.method,e.url,e.data,e.options,e.before);for(d=0;D=e.success[d];++d)k.success(D);for(d=0;D=e.error[d];++d)k.error(D);for(d=0;D=e.complete[d];++d)k.complete(D)}try{if(200!=m.status)throw m.status+
" ("+m.statusText+")";if("text"==t||"html"==t)l=m.responseText;else if(F&&void 0!==m.response)l=m.response;else switch(t){case "json":try{a.JSON?l=a.JSON.parse(m.responseText):l=eval("("+m.responseText+")")}catch(q){throw"Error while parsing JSON body";}break;case "js":l=eval(m.responseText);break;case "xml":if(!m.responseXML||m.responseXML.parseError&&m.responseXML.parseError.errorCode&&m.responseXML.parseError.reason)throw"Error while parsing XML body";l=m.responseXML;break;default:throw"Unsupported "+
t+" type";}K=!0;if(y)for(d=0;D=s[d];++d)D.apply(m,[l])}catch(n){if(I=!0,l="Request to '"+C+"' aborted: "+n,y)for(d=0;D=c[d];++d)D.apply(m,[l])}if(y)for(d=0;D=f[d];++d)D.apply(m)};if(d&&g==d)return h.push({method:z,url:C,data:v,options:x,before:E,success:[],error:[],complete:[]}),q;++g;if(a.ArrayBuffer&&(v instanceof ArrayBuffer||v instanceof Blob||v instanceof Document||v instanceof FormData))"GET"==z&&(v=null);else{x=[];B=encodeURIComponent;for(e in v)x.push(B(e)+(v[e].pop?"[]":"")+"="+B(v[e]));
v=x.join("&");B=!0}"GET"==z&&(p+=v);A||(p&&(p+="&"),p+="t="+Date.now());p&&(C+=(/\?/.test(C)?"&":"?")+p);m.open(z,C,y,G,H);if(t&&n)try{m.responseType=t,F=m.responseType==t}catch(P){}n?m.onload=L:m.onreadystatechange=function(){4==m.readyState&&L()};B&&"POST"==z&&(r["Content-Type"]="application/x-www-form-urlencoded");r.Accept={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}[t];for(e in r)m.setRequestHeader(e,
r[e]);return E&&E.apply(m),m.send("POST"==z?v:null),J};return{get:function(d,a,h,g){return u("GET",d,a,h,g)},post:function(d,a,h,g){return u("POST",d,a,h,g)},xhr2:n,limit:function(a){d=a}}}();"undefined"==typeof window&&(window={});window.console=window.console||{log:function(){},error:function(){},warn:function(){},trace:function(){}};function assert(a,d){if(!a)throw d||"Assertion failed.";}"undefined"!=typeof exports?exports.assert=assert:window.cip_common={assert:assert};"undefined"!=typeof require&&(cip_table=require("./cip-table.js"),cip_common=require("./cip-common.js"));
function CIPCatalog(a,d){this.cip=a;for(var g in d)this[g]=d[g];void 0===this.alias&&(this.alias=a.config.catalog_aliases[this.name]);this.get_tables=function(d){cip_common.assert(this.cip.is_connected());var g=[],n=this;this.cip.ciprequest("metadata/gettables/"+a.config.constants.catch_all_alias,{catalogname:this.name},function(a,z){for(var C=0;C<a.tables.length;C++)g.push(new cip_table.CIPTable(this,n,a.tables[C]));d(g)})};this.get_categories=function(d,a,g){cip_common.assert(this.cip.is_connected());
this.cip.ciprequest("metadata/getcategories/"+this.alias+"/categories",{categoryid:d,levels:a},function(d,a){g(d)})}}"undefined"!=typeof exports?exports.CIPCatalog=CIPCatalog:window.cip_catalog={CIPCatalog:CIPCatalog};"undefined"!=typeof require&&(cip_common=require("./cip-common.js"));
function CIPTable(a,d,g){this.cip=a;this.catalog=d;this.name=g;this.layout=null;this.get_layout=function(d){cip_common.assert(this.cip.is_connected());var a=this.cip;this.cip.ciprequest("metadata/getlayout/"+this.cip.config.constants.layout_alias,{catalogname:this.catalog.name,table:this.name},function(g){this.layout=g;d(new CIPLayout(a,this.layout.fields))})};this.search=function(d,a){this.cip.search(this,d,a)};this.criteriasearch=function(d,a){this.cip.criteriasearch(this,d,a)}}
"undefined"!=typeof exports?exports.CIPTable=CIPTable:window.cip_table={CIPTable:CIPTable};function CIPAsset(a,d,g){this.cip=a;this.fields=d;this.get_field_value=function(d){};this.get_fields=function(){};this.get_asset_url=function(d){var a={};void 0!==d&&(a.version=d);return this.cip.generate_url("asset/download/"+g.alias+"/"+this.fields.id,a)};this.get_versions=function(d){this.cip.ciprequest("asset/getversions/"+g.alias+"/"+this.fields.id,{},function(a){d(a.versions)})};this.get_image_url=function(d){return this.cip.generate_url("preview/image/"+g.alias+"/"+this.fields.id,d)};this.get_thumbnail_url=
function(d){var a={},n=["size","maxsize","rotate","format","quality"];void 0===d&&(d={});for(var u in n)void 0!==d[n[u]]&&(a[n[u]]="format"!==n[u]?parseInt(d[n[u]]):d[n[u]]);return this.cip.generate_url("preview/thumbnail/"+g.alias+"/"+this.fields.id,a)};this.get_related_assets=function(d,a){return this.cip.ciprequest(["metadata","getrelatedassets",g.alias,this.fields.id,d],{},a)}}"undefined"!=typeof exports?exports.CIPAsset=CIPAsset:window.cip_asset={CIPAsset:CIPAsset};"undefined"!=typeof require&&(cip_asset=require("./cip-asset.js"));function CIPSearchResult(a,d,g){this.cip=a;this.total_rows=d.totalcount;this.collection_id=d.collection;this.catalog=g;this.get=function(d,a,n){var u=[];void 0===d&&(d=100);this.cip.ciprequest("metadata/getfieldvalues/web",{collection:this.collection_id,startindex:a,maxreturned:d},function(d){for(var a=0;a<d.items.length;a++)u.push(new cip_asset.CIPAsset(this,d.items[a],g));n(u)})}}
"undefined"!=typeof exports?exports.CIPSearchResult=CIPSearchResult:window.cip_searchresult={CIPSearchResult:CIPSearchResult};function CIPLayout(a,d){this.cip=a;this.fields=d;this.cache={};this.lookup_field=function(a){if(void 0!==this.cache[a])return this.cache[a];for(var h=0;h<d.length;h++)if(this.fields[h].key===a)return this.cache[a]=this.fields[h],this.fields[h]}}"undefined"!=typeof exports&&(exports.CIPLayout=CIPLayout);"undefined"!=typeof require&&(request=require("request"),cip_catalog=require("./cip-catalog.js"),cip_searchresult=require("./cip-searchresult.js"),cip_common=require("./cip-common.js"));
function CIPClient(a){this.config=a;this.jsessionid=null;this.DEBUG=!0;cip_common.assert(void 0!==a,"The CIPClient must be passed a config object.");cip_common.assert(void 0!==a.endpoint,"The config must have an endpoint property.");this.cache={catalogs:null};this.default_named_parameters={apiversion:4,serveraddress:"localhost"};this.named_parameters_with_defaults=function(d){var a={},h;for(h in this.default_named_parameters)a[h]=this.default_named_parameters[h];if("undefined"===typeof d||null===
d)d={};else if("object"!==typeof d)throw"The named_parameters parameter must be an object, undefined or null.";for(h in d)a[h]=d[h];return a};this.generate_url=function(d,a,h){d=this.config.endpoint+d;var k="";!0!==h&&this.jsessionid&&(d+=";jsessionid="+this.jsessionid);a=!1!==a?this.named_parameters_with_defaults(a):{};for(var n in a)0<k.length&&(k+="&"),k+=n+"="+a[n];0<k.length&&(d+="?"+k);return d};this.ciprequest=function(a,g,h,k,n){"object"===typeof a&&(a=a.join("/"));void 0===n&&(n=!1);null===
this.jsessionid&&"session/open"!==a&&console.warn("No jsessionid - consider calling session_open before calling other action.");h="function"===typeof h?h.bind(this):function(a){console.warn("Unhandled success from the CIP - consider adding a success callback function the ciprequest call.");console.log(a)};k="function"===typeof k?k.bind(this):function(a){console.warn("Unhandled error from the CIP - consider adding an error callback function the ciprequest call.");console.error("An error occured when communicating with the CIP.",
a);console.trace()};g=this.named_parameters_with_defaults(g);a=this.generate_url(a,!1);if("undefined"!=typeof require&&request)return request.post({url:a,method:"POST",form:g},function(a,d,g){a||200!=d.statusCode?k(d):""===d.body?h(!0):h(JSON.parse(d.body))});if(qwest&&"object"===typeof qwest)return qwest.post(a,g,{async:n}).success(h).error(k)};this.session_open=function(a,g,h,k){var n=this;this.ciprequest("session/open",{user:a,password:g},function(a){if(a.jsessionid)n.jsessionid=a.jsessionid,console.log("Connected to CIP: "+
n.jsessionid),h(a);else{debugger;console.log("SessionID is missing!")}},function(a){k&&k(a)||console.error("Could not make request to CIP.")},!0)};this.session_close=function(){this.ciprequest("session/close",{})};this.is_connected=function(){return null!==this.jsessionid};this.get_catalogs=function(a){cip_common.assert(this.is_connected());null!==this.cache.catalogs&&a(this.cache.catalogs);this.ciprequest("metadata/getcatalogs",{},function(g){this.cache.catalogs=[];for(var h=this.config.catalog_aliases,
k=0;k<g.catalogs.length;k++)if(g.catalogs[k].name in h){var n=new cip_catalog.CIPCatalog(this,g.catalogs[k]);this.cache.catalogs.push(n)}a(this.cache.catalogs)})};this.search=function(a,g,h){cip_common.assert(this.is_connected());cip_common.assert(void 0!==a.catalog.alias,"Catalog must have an alias.");cip_common.assert(void 0!==g&&""!==g,"Must define a query");this.ciprequest("metadata/search/"+a.catalog.alias,{quicksearchstring:g,table:a.name,collection:""},function(g){h(new cip_searchresult.CIPSearchResult(this,
g,a.catalog))})};this.criteriasearch=function(a,g,h,k,n){cip_common.assert(this.is_connected());cip_common.assert(void 0!==a.catalog.alias,"Catalog must have an alias.");cip_common.assert(void 0!==g&&""!==g,"Must define a query");this.ciprequest("metadata/search/"+a.catalog.alias,{querystring:g,sortby:h,table:a.name,collection:""},function(g){k(new cip_searchresult.CIPSearchResult(this,g,a.catalog))},n)};this.get_asset=function(a,g,h,k,n){cip_common.assert(this.is_connected());cip_common.assert(void 0!==
a,"Catalog must have an alias.");cip_common.assert(void 0!==g,"The asset_id must have a value.");a=new cip_catalog.CIPCatalog(this,{alias:a});!0===h?(h=new cip_table.CIPTable(this,a,"AssetRecords"),this.criteriasearch(h,"id == "+g,null,function(a){a.get(1,0,function(a){1!==a.length?(console.warn("The criteriasearch didn't return exactly one result. Check parameters."),n(a)):k(a[0])})},n)):(g=new cip_asset.CIPAsset(this,{id:g},a),k(g))};this.get_version=function(a){cip_common.assert("function"===typeof a,
"The callback must be a function.");this.ciprequest("system/getversion",{},function(g){a(g.version)})}}"undefined"!=typeof exports&&(exports.CIPClient=CIPClient);var Zepto=function(){function a(b){return null==b?String(b):Q[W.call(b)]||"object"}function d(b){return"function"==a(b)}function g(b){return null!=b&&b==b.window}function h(b){return null!=b&&b.nodeType==b.DOCUMENT_NODE}function k(b){return"object"==a(b)}function n(b){return k(b)&&!g(b)&&Object.getPrototypeOf(b)==Object.prototype}function u(b){return b instanceof Array}function z(b){return"number"==typeof b.length}function C(b){return f.call(b,function(b){return null!=b})}function v(b){return b.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function x(b){return b in I?I[b]:I[b]=RegExp("(^|\\s)"+b+"(\\s|$)")}function E(b,a){return"number"!=typeof a||D[v(b)]?a:a+"px"}function F(b){return"children"in b?c.call(b.children):e.map(b.childNodes,function(b){if(1==b.nodeType)return b})}function m(b,a,c){for(p in a)c&&(n(a[p])||u(a[p]))?(n(a[p])&&!n(b[p])&&(b[p]={}),u(a[p])&&!u(b[p])&&(b[p]=[]),m(b[p],a[p],c)):a[p]!==r&&(b[p]=a[p])}
function y(b,a){return null==a?e(b):e(b).filter(a)}function A(b,a,c,f){return d(a)?a.call(b,c,f):a}function t(b,a){var c=b.className,f=c&&c.baseVal!==r;if(a===r)return f?c.baseVal:c;f?c.baseVal=a:b.className=a}function G(b){var a;try{return b?"true"==b||("false"==b?!1:"null"==b?null:/^0/.test(b)||isNaN(a=Number(b))?/^[\[\{]/.test(b)?e.parseJSON(b):b:a):b}catch(c){return b}}function H(b,a){a(b);for(var c in b.childNodes)H(b.childNodes[c],a)}var r,p,e,B,s=[],c=s.slice,f=s.filter,l=window.document,K=
{},I={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},J=/^\s*<(\w+|!)[^>]*>/,q=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,L=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,P=/^(?:body|html)$/i,U=/([A-Z])/g,V="val css html text data width height offset".split(" "),O=l.createElement("table"),R=l.createElement("tr"),S={tr:l.createElement("tbody"),tbody:O,thead:O,tfoot:O,td:R,th:R,"*":l.createElement("div")},X=/complete|loaded|interactive/,Y=/^[\w-]*$/,
Q={},W=Q.toString,w={},M,N,T=l.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};return w.matches=function(b,a){if(!a||!b||1!==b.nodeType)return!1;var c=b.webkitMatchesSelector||b.mozMatchesSelector||b.oMatchesSelector||b.matchesSelector;if(c)return c.call(b,a);var f,
c=b.parentNode,d=!c;return d&&(c=T).appendChild(b),f=~w.qsa(c,a).indexOf(b),d&&T.removeChild(b),f},M=function(b){return b.replace(/-+(.)?/g,function(b,a){return a?a.toUpperCase():""})},N=function(b){return f.call(b,function(a,c){return b.indexOf(a)==c})},w.fragment=function(b,a,f){var d,s,g;return q.test(b)&&(d=e(l.createElement(RegExp.$1))),d||(b.replace&&(b=b.replace(L,"<$1></$2>")),a===r&&(a=J.test(b)&&RegExp.$1),a in S||(a="*"),g=S[a],g.innerHTML=""+b,d=e.each(c.call(g.childNodes),function(){g.removeChild(this)})),
n(f)&&(s=e(d),e.each(f,function(b,a){-1<V.indexOf(b)?s[b](a):s.attr(b,a)})),d},w.Z=function(b,a){return b=b||[],b.__proto__=e.fn,b.selector=a||"",b},w.isZ=function(b){return b instanceof w.Z},w.init=function(b,a){var c;if(!b)return w.Z();if("string"==typeof b)if(b=b.trim(),"<"==b[0]&&J.test(b))c=w.fragment(b,RegExp.$1,a),b=null;else{if(a!==r)return e(a).find(b);c=w.qsa(l,b)}else{if(d(b))return e(l).ready(b);if(w.isZ(b))return b;if(u(b))c=C(b);else if(k(b))c=[b],b=null;else if(J.test(b))c=w.fragment(b.trim(),
RegExp.$1,a),b=null;else{if(a!==r)return e(a).find(b);c=w.qsa(l,b)}}return w.Z(c,b)},e=function(b,a){return w.init(b,a)},e.extend=function(b){var a,f=c.call(arguments,1);return"boolean"==typeof b&&(a=b,b=f.shift()),f.forEach(function(c){m(b,c,a)}),b},w.qsa=function(b,a){var f,d="#"==a[0],s=!d&&"."==a[0],l=d||s?a.slice(1):a,e=Y.test(l);return h(b)&&e&&d?(f=b.getElementById(l))?[f]:[]:1!==b.nodeType&&9!==b.nodeType?[]:c.call(e&&!d?s?b.getElementsByClassName(l):b.getElementsByTagName(a):b.querySelectorAll(a))},
e.contains=function(b,a){return b!==a&&b.contains(a)},e.type=a,e.isFunction=d,e.isWindow=g,e.isArray=u,e.isPlainObject=n,e.isEmptyObject=function(b){for(var a in b)return!1;return!0},e.inArray=function(b,a,c){return s.indexOf.call(a,b,c)},e.camelCase=M,e.trim=function(b){return null==b?"":String.prototype.trim.call(b)},e.uuid=0,e.support={},e.expr={},e.map=function(b,a){var c,f=[],d;if(z(b))for(d=0;d<b.length;d++)c=a(b[d],d),null!=c&&f.push(c);else for(d in b)c=a(b[d],d),null!=c&&f.push(c);return 0<
f.length?e.fn.concat.apply([],f):f},e.each=function(b,a){var c;if(z(b))for(c=0;c<b.length&&!1!==a.call(b[c],c,b[c]);c++);else for(c in b)if(!1===a.call(b[c],c,b[c]))break;return b},e.grep=function(b,a){return f.call(b,a)},window.JSON&&(e.parseJSON=JSON.parse),e.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b,a){Q["[object "+a+"]"]=a.toLowerCase()}),e.fn={forEach:s.forEach,reduce:s.reduce,push:s.push,sort:s.sort,indexOf:s.indexOf,concat:s.concat,map:function(b){return e(e.map(this,
function(a,c){return b.call(a,c,a)}))},slice:function(){return e(c.apply(this,arguments))},ready:function(b){return X.test(l.readyState)&&l.body?b(e):l.addEventListener("DOMContentLoaded",function(){b(e)},!1),this},get:function(b){return b===r?c.call(this):this[0<=b?b:b+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(b){return s.every.call(this,
function(a,c){return!1!==b.call(a,c,a)}),this},filter:function(b){return d(b)?this.not(this.not(b)):e(f.call(this,function(a){return w.matches(a,b)}))},add:function(b,a){return e(N(this.concat(e(b,a))))},is:function(b){return 0<this.length&&w.matches(this[0],b)},not:function(b){var a=[];if(d(b)&&b.call!==r)this.each(function(c){b.call(this,c)||a.push(this)});else{var f="string"==typeof b?this.filter(b):z(b)&&d(b.item)?c.call(b):e(b);this.forEach(function(b){0>f.indexOf(b)&&a.push(b)})}return e(a)},
has:function(b){return this.filter(function(){return k(b)?e.contains(this,b):e(this).find(b).size()})},eq:function(b){return-1===b?this.slice(b):this.slice(b,+b+1)},first:function(){var b=this[0];return b&&!k(b)?b:e(b)},last:function(){var b=this[this.length-1];return b&&!k(b)?b:e(b)},find:function(b){var a,c=this;return"object"==typeof b?a=e(b).filter(function(){var b=this;return s.some.call(c,function(a){return e.contains(a,b)})}):1==this.length?a=e(w.qsa(this[0],b)):a=this.map(function(){return w.qsa(this,
b)}),a},closest:function(b,a){var c=this[0],f=!1;for("object"==typeof b&&(f=e(b));c&&!(f?0<=f.indexOf(c):w.matches(c,b));)c=c!==a&&!h(c)&&c.parentNode;return e(c)},parents:function(b){for(var a=[],c=this;0<c.length;)c=e.map(c,function(b){if((b=b.parentNode)&&!h(b)&&0>a.indexOf(b))return a.push(b),b});return y(a,b)},parent:function(b){return y(N(this.pluck("parentNode")),b)},children:function(b){return y(this.map(function(){return F(this)}),b)},contents:function(){return this.map(function(){return c.call(this.childNodes)})},
siblings:function(b){return y(this.map(function(b,a){return f.call(F(a.parentNode),function(b){return b!==a})}),b)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(b){return e.map(this,function(a){return a[b]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display="");if("none"==getComputedStyle(this,"").getPropertyValue("display")){var b=this.style,a;a=this.nodeName;var c,f;a=(K[a]||(c=l.createElement(a),l.body.appendChild(c),
f=getComputedStyle(c,"").getPropertyValue("display"),c.parentNode.removeChild(c),"none"==f&&(f="block"),K[a]=f),K[a]);b.display=a}})},replaceWith:function(b){return this.before(b).remove()},wrap:function(b){var a=d(b);if(this[0]&&!a)var c=e(b).get(0),f=c.parentNode||1<this.length;return this.each(function(d){e(this).wrapAll(a?b.call(this,d):f?c.cloneNode(!0):c)})},wrapAll:function(b){if(this[0]){e(this[0]).before(b=e(b));for(var a;(a=b.children()).length;)b=a.first();e(b).append(this)}return this},
wrapInner:function(b){var a=d(b);return this.each(function(c){var f=e(this),d=f.contents();c=a?b.call(this,c):b;d.length?d.wrapAll(c):f.append(c)})},unwrap:function(){return this.parent().each(function(){e(this).replaceWith(e(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(b){return this.each(function(){var a=e(this);(b===r?"none"==a.css("display"):b)?a.show():a.hide()})},prev:function(b){return e(this.pluck("previousElementSibling")).filter(b||
"*")},next:function(b){return e(this.pluck("nextElementSibling")).filter(b||"*")},html:function(b){return 0===arguments.length?0<this.length?this[0].innerHTML:null:this.each(function(a){var c=this.innerHTML;e(this).empty().append(A(this,b,a,c))})},text:function(b){return 0===arguments.length?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=b===r?"":""+b})},attr:function(b,a){var c;return"string"==typeof b&&a===r?0==this.length||1!==this[0].nodeType?r:"value"==b&&"INPUT"==
this[0].nodeName?this.val():!(c=this[0].getAttribute(b))&&b in this[0]?this[0][b]:c:this.each(function(c){if(1===this.nodeType)if(k(b))for(p in b){c=p;var f=b[p];null==f?this.removeAttribute(c):this.setAttribute(c,f)}else c=A(this,a,c,this.getAttribute(b)),null==c?this.removeAttribute(b):this.setAttribute(b,c)})},removeAttr:function(b){return this.each(function(){1===this.nodeType&&this.removeAttribute(b)})},prop:function(b,a){return b=Z[b]||b,a===r?this[0]&&this[0][b]:this.each(function(c){this[b]=
A(this,a,c,this[b])})},data:function(b,a){var c=this.attr("data-"+b.replace(U,"-$1").toLowerCase(),a);return null!==c?G(c):r},val:function(b){return 0===arguments.length?this[0]&&(this[0].multiple?e(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(a){this.value=A(this,b,a,this.value)})},offset:function(b){if(b)return this.each(function(a){var c=e(this);a=A(this,b,a,c.offset());var f=c.offsetParent().offset();a={top:a.top-f.top,left:a.left-
f.left};"static"==c.css("position")&&(a.position="relative");c.css(a)});if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:Math.round(a.width),height:Math.round(a.height)}},css:function(b,c){if(2>arguments.length){var f=this[0],d=getComputedStyle(f,"");if(!f)return;if("string"==typeof b)return f.style[M(b)]||d.getPropertyValue(b);if(u(b)){var s={};return e.each(u(b)?b:[b],function(b,a){s[a]=f.style[M(a)]||d.getPropertyValue(a)}),
s}}var l="";if("string"==a(b))c||0===c?l=v(b)+":"+E(b,c):this.each(function(){this.style.removeProperty(v(b))});else for(p in b)b[p]||0===b[p]?l+=v(p)+":"+E(p,b[p])+";":this.each(function(){this.style.removeProperty(v(p))});return this.each(function(){this.style.cssText+=";"+l})},index:function(b){return b?this.indexOf(e(b)[0]):this.parent().children().indexOf(this[0])},hasClass:function(b){return b?s.some.call(this,function(b){return this.test(t(b))},x(b)):!1},addClass:function(b){return b?this.each(function(a){B=
[];var c=t(this);A(this,b,a,c).split(/\s+/g).forEach(function(b){e(this).hasClass(b)||B.push(b)},this);B.length&&t(this,c+(c?" ":"")+B.join(" "))}):this},removeClass:function(b){return this.each(function(a){if(b===r)return t(this,"");B=t(this);A(this,b,a,B).split(/\s+/g).forEach(function(b){B=B.replace(x(b)," ")});t(this,B.trim())})},toggleClass:function(b,a){return b?this.each(function(c){var f=e(this);A(this,b,c,t(this)).split(/\s+/g).forEach(function(b){(a===r?!f.hasClass(b):a)?f.addClass(b):f.removeClass(b)})}):
this},scrollTop:function(b){if(this.length){var a="scrollTop"in this[0];return b===r?a?this[0].scrollTop:this[0].pageYOffset:this.each(a?function(){this.scrollTop=b}:function(){this.scrollTo(this.scrollX,b)})}},scrollLeft:function(b){if(this.length){var a="scrollLeft"in this[0];return b===r?a?this[0].scrollLeft:this[0].pageXOffset:this.each(a?function(){this.scrollLeft=b}:function(){this.scrollTo(b,this.scrollY)})}},position:function(){if(this.length){var a=this[0],c=this.offsetParent(),f=this.offset(),
d=P.test(c[0].nodeName)?{top:0,left:0}:c.offset();return f.top-=parseFloat(e(a).css("margin-top"))||0,f.left-=parseFloat(e(a).css("margin-left"))||0,d.top+=parseFloat(e(c[0]).css("border-top-width"))||0,d.left+=parseFloat(e(c[0]).css("border-left-width"))||0,{top:f.top-d.top,left:f.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||l.body;a&&!P.test(a.nodeName)&&"static"==e(a).css("position");)a=a.offsetParent;return a})}},e.fn.detach=e.fn.remove,["width",
"height"].forEach(function(a){var c=a.replace(/./,function(a){return a[0].toUpperCase()});e.fn[a]=function(f){var d,l=this[0];return f===r?g(l)?l["inner"+c]:h(l)?l.documentElement["scroll"+c]:(d=this.offset())&&d[a]:this.each(function(c){l=e(this);l.css(a,A(this,f,c,l[a]()))})}}),["after","prepend","before","append"].forEach(function(b,c){var f=c%2;e.fn[b]=function(){var b,d=e.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:w.fragment(c)}),l,s=1<this.length;return 1>d.length?
this:this.each(function(a,b){l=f?b:b.parentNode;b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null;d.forEach(function(a){if(s)a=a.cloneNode(!0);else if(!l)return e(a).remove();H(l.insertBefore(a,b),function(a){null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src||window.eval.call(window,a.innerHTML)})})})};e.fn[f?b+"To":"insert"+(c?"Before":"After")]=function(a){return e(a)[b](this),this}}),w.Z.prototype=e.fn,w.uniq=N,w.deserializeValue=G,e.zepto=w,e}();
window.Zepto=Zepto;void 0===window.$&&(window.$=Zepto);
(function(a){function d(a){return a._zid||(a._zid=v++)}function g(a,c,f,l){c=h(c);if(c.ns)var e=RegExp("(?:^| )"+c.ns.replace(" "," .* ?")+"(?: |$)");return(y[d(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||e.test(a.ns))&&(!f||d(a.fn)===d(f))&&(!l||a.sel==l)})}function h(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function k(a){return H[a]||t&&G[a]||a}function n(e,c,f,l,g,I,n){var m=d(e),q=y[m]||(y[m]=[]);c.split(/\s/).forEach(function(c){if("ready"==c)return a(document).ready(f);
var d=h(c);d.fn=f;d.sel=g;d.e in H&&(f=function(c){var f=c.relatedTarget;if(!f||f!==this&&!a.contains(this,f))return d.fn.apply(this,arguments)});var m=(d.del=I)||f;d.proxy=function(a){a=z(a);if(!a.isImmediatePropagationStopped()){a.data=l;var c=m.apply(e,a._args==x?[a]:[a].concat(a._args));return!1===c&&(a.preventDefault(),a.stopPropagation()),c}};d.i=q.length;q.push(d);"addEventListener"in e&&e.addEventListener(k(d.e),d.proxy,d.del&&!t&&d.e in G||!!n)})}function u(a,c,f,l,e){var h=d(a);(c||"").split(/\s/).forEach(function(c){g(a,
c,f,l).forEach(function(c){delete y[h][c.i];"removeEventListener"in a&&a.removeEventListener(k(c.e),c.proxy,c.del&&!t&&c.e in G||!!e)})})}function z(d,c){if(c||!d.isDefaultPrevented)if(c||(c=d),a.each(B,function(a,l){var e=c[a];d[a]=function(){return this[l]=r,e&&e.apply(c,arguments)};d[l]=p}),c.defaultPrevented!==x?c.defaultPrevented:"returnValue"in c?!1===c.returnValue:c.getPreventDefault&&c.getPreventDefault())d.isDefaultPrevented=r;return d}function C(a){var c,f={originalEvent:a};for(c in a)!e.test(c)&&
a[c]!==x&&(f[c]=a[c]);return z(f,a)}var v=1,x,E=Array.prototype.slice,F=a.isFunction,m=function(a){return"string"==typeof a},y={},A={},t="onfocusin"in window,G={focus:"focusin",blur:"focusout"},H={mouseenter:"mouseover",mouseleave:"mouseout"};A.click=A.mousedown=A.mouseup=A.mousemove="MouseEvents";a.event={add:n,remove:u};a.proxy=function(e,c){if(F(e)){var f=function(){return e.apply(c,arguments)};return f._zid=d(e),f}if(m(c))return a.proxy(e[c],e);throw new TypeError("expected function");};a.fn.bind=
function(a,c,f){return this.on(a,c,f)};a.fn.unbind=function(a,c){return this.off(a,c)};a.fn.one=function(a,c,f,d){return this.on(a,c,f,d,1)};var r=function(){return!0},p=function(){return!1},e=/^([A-Z]|returnValue$|layer[XY]$)/,B={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,c,f){return this.on(c,a,f)};a.fn.undelegate=function(a,c,f){return this.off(c,a,f)};a.fn.live=function(d,c){return a(document.body).delegate(this.selector,
d,c),this};a.fn.die=function(d,c){return a(document.body).undelegate(this.selector,d,c),this};a.fn.on=function(d,c,f,l,e){var g,h,k=this;if(d&&!m(d))return a.each(d,function(a,d){k.on(a,c,f,d,e)}),k;!m(c)&&!F(l)&&!1!==l&&(l=f,f=c,c=x);if(F(f)||!1===f)l=f,f=x;return!1===l&&(l=p),k.each(function(q,k){e&&(g=function(a){return u(k,a.type,l),l.apply(this,arguments)});c&&(h=function(f){var d,e=a(f.target).closest(c,k).get(0);if(e&&e!==k)return d=a.extend(C(f),{currentTarget:e,liveFired:k}),(g||l).apply(e,
[d].concat(E.call(arguments,1)))});n(k,d,l,f,c,h||g)})};a.fn.off=function(d,c,f){var e=this;return d&&!m(d)?(a.each(d,function(a,f){e.off(a,c,f)}),e):(!m(c)&&!F(f)&&!1!==f&&(f=c,c=x),!1===f&&(f=p),e.each(function(){u(this,d,f,c)}))};a.fn.trigger=function(d,c){return d=m(d)||a.isPlainObject(d)?a.Event(d):z(d),d._args=c,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(d):a(this).triggerHandler(d,c)})};a.fn.triggerHandler=function(d,c){var f,e;return this.each(function(h,k){f=C(m(d)?a.Event(d):
d);f._args=c;f.target=k;a.each(g(k,d.type||d),function(a,c){e=c.proxy(f);if(f.isImmediatePropagationStopped())return!1})}),e};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(d){a.fn[d]=function(a){return a?this.bind(d,a):this.trigger(d)}});["focus","blur"].forEach(function(d){a.fn[d]=function(a){return a?this.bind(d,a):this.each(function(){try{this[d]()}catch(a){}}),
this}});a.Event=function(a,c){m(a)||(c=a,a=c.type);var d=document.createEvent(A[a]||"Events"),e=!0;if(c)for(var g in c)"bubbles"==g?e=!!c[g]:d[g]=c[g];return d.initEvent(a,e,!0),z(d)}})(Zepto);
(function(a){function d(c,d,e,g){if(c.global)return c=d||y,e=a.Event(e),a(c).trigger(e,g),!e.isDefaultPrevented()}function g(c){c.global&&0===a.active++&&d(c,null,"ajaxStart")}function h(a,f){var e=f.context;if(!1===f.beforeSend.call(e,a,f)||!1===d(f,e,"ajaxBeforeSend",[a,f]))return!1;d(f,e,"ajaxSend",[a,f])}function k(a,f,e,g){var h=e.context;e.success.call(h,a,"success",f);g&&g.resolveWith(h,[a,"success",f]);d(e,h,"ajaxSuccess",[f,e,a]);u("success",f,e)}function n(a,f,e,g,h){var k=g.context;g.error.call(k,
e,f,a);h&&h.rejectWith(k,[e,f,a]);d(g,k,"ajaxError",[e,g,a||f]);u(f,e,g)}function u(c,f,e){var g=e.context;e.complete.call(g,f,c);d(e,g,"ajaxComplete",[f,e]);e.global&&!--a.active&&d(e,null,"ajaxStop")}function z(){}function C(a){return a&&(a=a.split(";",2)[0]),a&&(a==e?"html":a==p?"json":H.test(a)?"script":r.test(a)&&"xml")||"text"}function v(a,d){return""==d?a:(a+"&"+d).replace(/[&?]{1,2}/,"?")}function x(c){c.processData&&c.data&&"string"!=a.type(c.data)&&(c.data=a.param(c.data,c.traditional));
c.data&&(!c.type||"GET"==c.type.toUpperCase())&&(c.url=v(c.url,c.data),c.data=void 0)}function E(c,d,e,g){var h=!a.isFunction(d);return{url:c,data:h?d:void 0,success:h?a.isFunction(e)?e:void 0:d,dataType:h?g||e:e}}function F(c,d,e,g){var h,k=a.isArray(d),n=a.isPlainObject(d);a.each(d,function(d,f){h=a.type(f);g&&(d=e?g:g+"["+(n||"object"==h||"array"==h?d:"")+"]");!g&&k?c.add(f.name,f.value):"array"==h||!e&&"object"==h?F(c,f,e,d):c.add(d,f)})}var m=0,y=window.document,A,t,G=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
H=/^(?:text|application)\/javascript/i,r=/^(?:text|application)\/xml/i,p="application/json",e="text/html",B=/^\s*$/;a.active=0;a.ajaxJSONP=function(c,d){if("type"in c){var e=c.jsonpCallback,g=(a.isFunction(e)?e():e)||"jsonp"+ ++m,p=y.createElement("script"),s=window[g],t,q=function(c){a(p).triggerHandler("error",c||"abort")},r={abort:q},u;return d&&d.promise(r),a(p).on("load error",function(e,h){clearTimeout(u);a(p).off().remove();"error"!=e.type&&t?k(t[0],r,c,d):n(null,h||"error",r,c,d);window[g]=
s;t&&a.isFunction(s)&&s(t[0]);s=t=void 0}),!1===h(r,c)?(q("abort"),r):(window[g]=function(){t=arguments},p.src=c.url.replace(/=\?/,"="+g),y.head.appendChild(p),0<c.timeout&&(u=setTimeout(function(){q("timeout")},c.timeout)),r)}return a.ajax(c)};a.ajaxSettings={type:"GET",beforeSend:z,success:z,error:z,complete:z,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:p,xml:"application/xml, text/xml",
html:e,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};a.ajax=function(c){var d=a.extend({},c||{}),e=a.Deferred&&a.Deferred();for(A in a.ajaxSettings)void 0===d[A]&&(d[A]=a.ajaxSettings[A]);g(d);d.crossDomain||(d.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(d.url)&&RegExp.$2!=window.location.host);d.url||(d.url=window.location.toString());x(d);!1===d.cache&&(d.url=v(d.url,"_="+Date.now()));var m=d.dataType;c=/=\?/.test(d.url);if("jsonp"==m||c)return c||(d.url=v(d.url,d.jsonp?d.jsonp+
"=?":!1===d.jsonp?"":"callback=?")),a.ajaxJSONP(d,e);c=d.accepts[m];var p={},r=function(a,c){p[a.toLowerCase()]=[a,c]},s=/^([\w-]+:)\/\//.test(d.url)?RegExp.$1:window.location.protocol,q=d.xhr(),u=q.setRequestHeader,y;e&&e.promise(q);d.crossDomain||r("X-Requested-With","XMLHttpRequest");r("Accept",c||"*/*");if(c=d.mimeType||c)-1<c.indexOf(",")&&(c=c.split(",",2)[0]),q.overrideMimeType&&q.overrideMimeType(c);(d.contentType||!1!==d.contentType&&d.data&&"GET"!=d.type.toUpperCase())&&r("Content-Type",
d.contentType||"application/x-www-form-urlencoded");if(d.headers)for(t in d.headers)r(t,d.headers[t]);q.setRequestHeader=r;q.onreadystatechange=function(){if(4==q.readyState){q.onreadystatechange=z;clearTimeout(y);var c,g=!1;if(200<=q.status&&300>q.status||304==q.status||0==q.status&&"file:"==s){m=m||C(d.mimeType||q.getResponseHeader("content-type"));c=q.responseText;try{"script"==m?(0,eval)(c):"xml"==m?c=q.responseXML:"json"==m&&(c=B.test(c)?null:a.parseJSON(c))}catch(h){g=h}g?n(g,"parsererror",
q,d,e):k(c,q,d,e)}else n(q.statusText||null,q.status?"error":"abort",q,d,e)}};if(!1===h(q,d))return q.abort(),n(null,"abort",q,d,e),q;if(d.xhrFields)for(t in d.xhrFields)q[t]=d.xhrFields[t];q.open(d.type,d.url,"async"in d?d.async:!0,d.username,d.password);for(t in p)u.apply(q,p[t]);return 0<d.timeout&&(y=setTimeout(function(){q.onreadystatechange=z;q.abort();n(null,"timeout",q,d,e)},d.timeout)),q.send(d.data?d.data:null),q};a.get=function(c,d,e,g){return a.ajax(E.apply(null,arguments))};a.post=function(c,
d,e,g){var h=E.apply(null,arguments);return h.type="POST",a.ajax(h)};a.getJSON=function(c,d,e){var g=E.apply(null,arguments);return g.dataType="json",a.ajax(g)};a.fn.load=function(c,d,e){if(!this.length)return this;var g=this,h=c.split(/\s/),k;c=E(c,d,e);var m=c.success;return 1<h.length&&(c.url=h[0],k=h[1]),c.success=function(c){g.html(k?a("<div>").html(c.replace(G,"")).find(k):c);m&&m.apply(g,arguments)},a.ajax(c),this};var s=encodeURIComponent;a.param=function(a,d){var e=[];return e.add=function(a,
c){this.push(s(a)+"="+s(c))},F(e,a,d),e.join("&").replace(/%20/g,"+")}})(Zepto);
(function(a){a.fn.serializeArray=function(){var d=[],g;return a([].slice.call(this.get(0).elements)).each(function(){g=a(this);var h=g.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=h&&"reset"!=h&&"button"!=h&&("radio"!=h&&"checkbox"!=h||this.checked)&&d.push({name:g.attr("name"),value:g.val()})}),d};a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(g){a.push(encodeURIComponent(g.name)+"="+encodeURIComponent(g.value))}),a.join("&")};
a.fn.submit=function(d){d?this.bind("submit",d):this.length&&(d=a.Event("submit"),this.eq(0).trigger(d),d.isDefaultPrevented()||this.get(0).submit());return this}})(Zepto);(function(a){"__proto__"in{}||a.extend(a.zepto,{Z:function(d,g){return d=d||[],a.extend(d,a.fn),d.selector=g||"",d.__Z=!0,d},isZ:function(d){return"array"===a.type(d)&&"__Z"in d}});try{getComputedStyle(void 0)}catch(d){var g=getComputedStyle;window.getComputedStyle=function(a){try{return g(a)}catch(d){return null}}}})(Zepto);
