/**
 * CIP.js, NatMus.js, qwest, underscore.js
 *
 * https://github.com/NationalMuseumofDenmark
 */
var qwest=function(){var a=window,c=null,h=0,g=[],k=function(){return a.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},p=""===k().responseType,r=function(s,C,w,y,E){w=w||null;y=y||{};var F=!1,m=k(),z=void 0===y.async?!0:!!y.async,A=!!y.cache,u=y.type?y.type.toLowerCase():"json",G=y.user||"",H=y.password||"",v={"X-Requested-With":"XMLHttpRequest"},n="",e,B,t=[],d=[],f=[],l,K,I,D,J={success:function(d){return z?t.push(d):K&&d.apply(m,[l]),J},error:function(f){return z?d.push(f):
I&&f.apply(m,[l]),J},complete:function(d){return z?f.push(d):d.apply(m),J}},q={success:function(d){return g[g.length-1].success.push(d),q},error:function(d){return g[g.length-1].error.push(d),q},complete:function(d){return g[g.length-1].complete.push(d),q}},L=function(){var c,e,k;--h;if(g.length){e=g.shift();k=r(e.method,e.url,e.data,e.options,e.before);for(c=0;D=e.success[c];++c)k.success(D);for(c=0;D=e.error[c];++c)k.error(D);for(c=0;D=e.complete[c];++c)k.complete(D)}try{if(200!=m.status)throw m.status+
" ("+m.statusText+")";if("text"==u||"html"==u)l=m.responseText;else if(F&&void 0!==m.response)l=m.response;else switch(u){case "json":try{a.JSON?l=a.JSON.parse(m.responseText):l=eval("("+m.responseText+")")}catch(q){throw"Error while parsing JSON body";}break;case "js":l=eval(m.responseText);break;case "xml":if(!m.responseXML||m.responseXML.parseError&&m.responseXML.parseError.errorCode&&m.responseXML.parseError.reason)throw"Error while parsing XML body";l=m.responseXML;break;default:throw"Unsupported "+
u+" type";}K=!0;if(z)for(c=0;D=t[c];++c)D.apply(m,[l])}catch(s){if(I=!0,l="Request to '"+C+"' aborted: "+s,z)for(c=0;D=d[c];++c)D.apply(m,[l])}if(z)for(c=0;D=f[c];++c)D.apply(m)};if(c&&h==c)return g.push({method:s,url:C,data:w,options:y,before:E,success:[],error:[],complete:[]}),q;++h;if(a.ArrayBuffer&&(w instanceof ArrayBuffer||w instanceof Blob||w instanceof Document||w instanceof FormData))"GET"==s&&(w=null);else{y=[];B=encodeURIComponent;for(e in w)y.push(B(e)+(w[e].pop?"[]":"")+"="+B(w[e]));
w=y.join("&");B=!0}"GET"==s&&(n+=w);A||(n&&(n+="&"),n+="t="+Date.now());n&&(C+=(/\?/.test(C)?"&":"?")+n);m.open(s,C,z,G,H);if(u&&p)try{m.responseType=u,F=m.responseType==u}catch(P){}p?m.onload=L:m.onreadystatechange=function(){4==m.readyState&&L()};B&&"POST"==s&&(v["Content-Type"]="application/x-www-form-urlencoded");v.Accept={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}[u];for(e in v)m.setRequestHeader(e,
v[e]);return E&&E.apply(m),m.send("POST"==s?w:null),J};return{get:function(c,a,g,h){return r("GET",c,a,g,h)},post:function(c,a,g,h){return r("POST",c,a,g,h)},xhr2:p,limit:function(a){c=a}}}();"undefined"==typeof window&&(window={});window.console=window.console||{log:function(){},error:function(){},warn:function(){},trace:function(){}};function assert(a,c){if(!a)throw c||"Assertion failed.";}"undefined"!=typeof exports?exports.assert=assert:window.cip_common={assert:assert};"undefined"!=typeof require&&(cip_table=require("./cip-table.js"),cip_common=require("./cip-common.js"));
function CIPCatalog(a,c){this.cip=a;for(var h in c)this[h]=c[h];void 0===this.alias&&(this.alias=a.config.catalog_aliases[this.name]);this.get_tables=function(c){cip_common.assert(this.cip.is_connected());var h=[],p=this;this.cip.ciprequest("metadata/gettables/"+a.config.constants.catch_all_alias,{catalogname:this.name},function(a,s){if(null!==a){for(var C=0;C<a.tables.length;C++)h.push(new cip_table.CIPTable(this,p,a.tables[C]));c(h)}else c(null)})};this.get_categories=function(c,a,h){cip_common.assert(this.cip.is_connected());
this.cip.ciprequest("metadata/getcategories/"+this.alias+"/categories",{categoryid:c,levels:a},function(c,a){null==c?h(null):h(c)})}}"undefined"!=typeof exports?exports.CIPCatalog=CIPCatalog:window.cip_catalog={CIPCatalog:CIPCatalog};"undefined"!=typeof require&&(cip_common=require("./cip-common.js"),cip_layout=require("./cip-layout.js"));
function CIPTable(a,c,h){this.cip=a;this.catalog=c;this.name=h;this.layout=null;this.get_layout=function(c){cip_common.assert(this.cip.is_connected());var a=this.cip,h=["metadata/getlayout",this.catalog.alias,this.cip.config.constants.layout_alias].join("/");this.cip.ciprequest(h,{table:this.name},function(h){this.layout=h;c(new cip_layout.CIPLayout(a,this.layout.fields))})};this.search=function(c,a){this.cip.search(this,c,a)};this.criteriasearch=function(c,a){this.cip.criteriasearch(this,c,a)}}
"undefined"!=typeof exports?exports.CIPTable=CIPTable:window.cip_table={CIPTable:CIPTable};function CIPAsset(a,c,h){this.cip=a;this.fields=c;this.get_field_value=function(c){};this.get_fields=function(){};this.get_asset_url=function(c){var a={};void 0!==c&&(a.version=c);return this.cip.generate_url("asset/download/"+h.alias+"/"+this.fields.id,a)};this.get_versions=function(c){this.cip.ciprequest("asset/getversions/"+h.alias+"/"+this.fields.id,{},function(a){c(a.versions)})};this.get_image_url=function(c){return this.cip.generate_url("preview/image/"+h.alias+"/"+this.fields.id,c)};this.get_thumbnail_url=
function(c,a){var p={},r=["size","maxsize","rotate","format","quality"];void 0===c&&(c={});for(var s in r)void 0!==c[r[s]]&&(p[r[s]]="format"!==r[s]?parseInt(c[r[s]]):c[r[s]]);return this.cip.generate_url("preview/thumbnail/"+h.alias+"/"+this.fields.id,p)};this.get_related_assets=function(c,a){return this.cip.ciprequest(["metadata","getrelatedassets",h.alias,this.fields.id,c],{},a)}}"undefined"!=typeof exports?exports.CIPAsset=CIPAsset:window.cip_asset={CIPAsset:CIPAsset};"undefined"!=typeof require&&(cip_asset=require("./cip-asset.js"));
function CIPSearchResult(a,c,h){if(!a||!c||!h)throw Error("Both CIP, collection and catalog must have values when creating a result.");this.cip=a;this.total_rows=c.totalcount;this.collection_id=c.collection;this.catalog=h;this.get=function(c,a,p,r){var s=[];void 0===c&&(c=100);this.cip.ciprequest("metadata/getfieldvalues/web",{collection:this.collection_id,startindex:a,maxreturned:c},function(c){if(null==c)r?r(Error("The request for field values returned a null result.")):p(null);else{for(var a=0;a<
c.items.length;a++)s.push(new cip_asset.CIPAsset(this,c.items[a],h));p(s)}},r)}}"undefined"!=typeof exports?exports.CIPSearchResult=CIPSearchResult:window.cip_searchresult={CIPSearchResult:CIPSearchResult};function CIPLayout(a,c){this.cip=a;this.fields=c;this.cache={};this.lookup_field=function(a){if(void 0!==this.cache[a])return this.cache[a];for(var g=0;g<c.length;g++)if(this.fields[g].key===a)return this.cache[a]=this.fields[g],this.fields[g]}}"undefined"!=typeof exports?exports.CIPLayout=CIPLayout:window.cip_layout={CIPLayout:CIPLayout};"undefined"!=typeof require&&(request=require("request"),cip_catalog=require("./cip-catalog.js"),cip_searchresult=require("./cip-searchresult.js"),cip_common=require("./cip-common.js"));
function CIPClient(a){this.config=a;this.jsessionid=null;this.DEBUG=!0;cip_common.assert(void 0!==a,"The CIPClient must be passed a config object.");cip_common.assert(void 0!==a.endpoint,"The config must have an endpoint property.");this.cache={catalogs:null};this.default_named_parameters={apiversion:4,serveraddress:"localhost"};this.named_parameters_with_defaults=function(c){var a={},g;for(g in this.default_named_parameters)a[g]=this.default_named_parameters[g];if("undefined"===typeof c||null===
c)c={};else if("object"!==typeof c)throw"The named_parameters parameter must be an object, undefined or null.";for(g in c){var k=c[g];null!==k&&void 0!==k&&(a[g]=k)}return a};this.generate_url=function(c,a,g){c=this.config.endpoint+c;var k="";!0!==g&&this.jsessionid&&(c+=";jsessionid="+this.jsessionid);a=!1!==a?this.named_parameters_with_defaults(a):{};for(var p in a)0<k.length&&(k+="&"),k+=p+"="+a[p];0<k.length&&(c+="?"+k);return c};this.ciprequest=function(c,a,g,k,p){"object"===typeof c&&(c=c.join("/"));
void 0===p&&(p=!1);null===this.jsessionid&&"session/open"!==c&&console.warn("No jsessionid - consider calling session_open before calling other action.");g="function"===typeof g?g.bind(this):function(a){console.warn("Unhandled success from the CIP - consider adding a success callback function the ciprequest call.");console.log(a)};"function"!==typeof k&&(k=function(a){console.warn("Unhandled error from the CIP - consider adding an error callback function the ciprequest call.");console.error("An error occured when communicating with the CIP.",
a);console.trace()});a=this.named_parameters_with_defaults(a);c=this.generate_url(c,!1);if("undefined"!=typeof require&&request)return request.post({url:c,method:"POST",form:a,timeout:0,useQuerystring:!0},function(a,c,h){null==c||void 0==c?k(null)||g(null):a||200!=c.statusCode?void 0===k?(console.log("No error function defined, calling success(null) :("),g(null)):k(c.body||null):""===c.body?g(!0):g(JSON.parse(c.body))});if(qwest&&"object"===typeof qwest)return qwest.post(c,a,{async:p}).success(g).error(k)};
this.session_open=function(a,h,g,k){var p=this;this.ciprequest("session/open",{user:a,password:h},function(a){if(a&&void 0!=a&&a.jsessionid)p.jsessionid=a.jsessionid,g(a);else{debugger;k("SessionID is missing from the response!")}},k,!0)};this.session_close=function(){this.ciprequest("session/close",{})};this.is_connected=function(){return null!==this.jsessionid};this.get_catalogs=function(a,h){cip_common.assert(this.is_connected());null!==this.cache.catalogs&&a(this.cache.catalogs);this.ciprequest("metadata/getcatalogs",
{},function(g){if(null==g)a(null);else{this.cache.catalogs=[];for(var h=this.config.catalog_aliases,p=0;p<g.catalogs.length;p++)if(g.catalogs[p].name in h){var r=new cip_catalog.CIPCatalog(this,g.catalogs[p]);this.cache.catalogs.push(r)}a(this.cache.catalogs)}},h)};this.search=function(a,h,g,k){return this.advancedsearch(a,void 0,h,void 0,g,k)};this.criteriasearch=function(a,h,g,k,p){return this.advancedsearch(a,h,void 0,g,k,p)};this.advancedsearch=function(a,h,g,k,p,r){cip_common.assert(this.is_connected());
cip_common.assert(void 0!==a.catalog.alias,"Catalog must have an alias.");cip_common.assert(void 0!==h||void 0!==g,"Either querystring or searchterm must be defined.");this.ciprequest(["metadata","search",a.catalog.alias],{querystring:h,quicksearchstring:g,sortby:k,table:a.name,collection:""},function(g){g?p(new cip_searchresult.CIPSearchResult(this,g,a.catalog)):r(Error("Received an empty result from the CIP, when searching."))},r)};this.get_asset=function(a,h,g,k,p){a=this.get_table(a);cip_common.assert(void 0!==
h,"The asset_id must have a value.");!0===g?this.criteriasearch(a,"id == "+h,null,function(a){a.get(1,0,function(a){1!==a.length?(console.warn("The criteriasearch didn't return exactly one result. Check parameters."),p(a)):k(a[0])})},p):(h=new cip_asset.CIPAsset(this,{id:h},a.catalog),k(h))};this.get_table=function(a,h){cip_common.assert(void 0!==a,"Catalog must have an alias.");"undefined"==typeof h&&(h="AssetRecords");var g=new cip_catalog.CIPCatalog(this,{alias:a});return new cip_table.CIPTable(this,
g,h)};this.get_version=function(a,h){cip_common.assert("function"===typeof a,"The callback must be a function.");this.ciprequest("system/getversion",{},function(g){a(g.version)},h)}}"undefined"!=typeof exports&&(exports.CIPClient=CIPClient);var Zepto=function(){function a(b){return null==b?String(b):Q[W.call(b)]||"object"}function c(b){return"function"==a(b)}function h(b){return null!=b&&b==b.window}function g(b){return null!=b&&b.nodeType==b.DOCUMENT_NODE}function k(b){return"object"==a(b)}function p(b){return k(b)&&!h(b)&&Object.getPrototypeOf(b)==Object.prototype}function r(b){return b instanceof Array}function s(b){return"number"==typeof b.length}function C(b){return f.call(b,function(b){return null!=b})}function w(b){return b.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function y(b){return b in I?I[b]:I[b]=RegExp("(^|\\s)"+b+"(\\s|$)")}function E(b,a){return"number"!=typeof a||D[w(b)]?a:a+"px"}function F(b){return"children"in b?d.call(b.children):e.map(b.childNodes,function(b){if(1==b.nodeType)return b})}function m(b,a,d){for(n in a)d&&(p(a[n])||r(a[n]))?(p(a[n])&&!p(b[n])&&(b[n]={}),r(a[n])&&!r(b[n])&&(b[n]=[]),m(b[n],a[n],d)):a[n]!==v&&(b[n]=a[n])}
function z(b,a){return null==a?e(b):e(b).filter(a)}function A(b,a,d,f){return c(a)?a.call(b,d,f):a}function u(b,a){var d=b.className,f=d&&d.baseVal!==v;if(a===v)return f?d.baseVal:d;f?d.baseVal=a:b.className=a}function G(b){var a;try{return b?"true"==b||("false"==b?!1:"null"==b?null:/^0/.test(b)||isNaN(a=Number(b))?/^[\[\{]/.test(b)?e.parseJSON(b):b:a):b}catch(d){return b}}function H(b,a){a(b);for(var d in b.childNodes)H(b.childNodes[d],a)}var v,n,e,B,t=[],d=t.slice,f=t.filter,l=window.document,K=
{},I={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},J=/^\s*<(\w+|!)[^>]*>/,q=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,L=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,P=/^(?:body|html)$/i,U=/([A-Z])/g,V="val css html text data width height offset".split(" "),O=l.createElement("table"),R=l.createElement("tr"),S={tr:l.createElement("tbody"),tbody:O,thead:O,tfoot:O,td:R,th:R,"*":l.createElement("div")},X=/complete|loaded|interactive/,Y=/^[\w-]*$/,
Q={},W=Q.toString,x={},M,N,T=l.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};return x.matches=function(b,a){if(!a||!b||1!==b.nodeType)return!1;var d=b.webkitMatchesSelector||b.mozMatchesSelector||b.oMatchesSelector||b.matchesSelector;if(d)return d.call(b,a);var f,
d=b.parentNode,c=!d;return c&&(d=T).appendChild(b),f=~x.qsa(d,a).indexOf(b),c&&T.removeChild(b),f},M=function(b){return b.replace(/-+(.)?/g,function(b,a){return a?a.toUpperCase():""})},N=function(b){return f.call(b,function(a,d){return b.indexOf(a)==d})},x.fragment=function(b,a,f){var c,t,g;return q.test(b)&&(c=e(l.createElement(RegExp.$1))),c||(b.replace&&(b=b.replace(L,"<$1></$2>")),a===v&&(a=J.test(b)&&RegExp.$1),a in S||(a="*"),g=S[a],g.innerHTML=""+b,c=e.each(d.call(g.childNodes),function(){g.removeChild(this)})),
p(f)&&(t=e(c),e.each(f,function(b,a){-1<V.indexOf(b)?t[b](a):t.attr(b,a)})),c},x.Z=function(b,a){return b=b||[],b.__proto__=e.fn,b.selector=a||"",b},x.isZ=function(b){return b instanceof x.Z},x.init=function(b,a){var d;if(!b)return x.Z();if("string"==typeof b)if(b=b.trim(),"<"==b[0]&&J.test(b))d=x.fragment(b,RegExp.$1,a),b=null;else{if(a!==v)return e(a).find(b);d=x.qsa(l,b)}else{if(c(b))return e(l).ready(b);if(x.isZ(b))return b;if(r(b))d=C(b);else if(k(b))d=[b],b=null;else if(J.test(b))d=x.fragment(b.trim(),
RegExp.$1,a),b=null;else{if(a!==v)return e(a).find(b);d=x.qsa(l,b)}}return x.Z(d,b)},e=function(b,a){return x.init(b,a)},e.extend=function(b){var a,f=d.call(arguments,1);return"boolean"==typeof b&&(a=b,b=f.shift()),f.forEach(function(d){m(b,d,a)}),b},x.qsa=function(b,a){var f,c="#"==a[0],t=!c&&"."==a[0],l=c||t?a.slice(1):a,e=Y.test(l);return g(b)&&e&&c?(f=b.getElementById(l))?[f]:[]:1!==b.nodeType&&9!==b.nodeType?[]:d.call(e&&!c?t?b.getElementsByClassName(l):b.getElementsByTagName(a):b.querySelectorAll(a))},
e.contains=function(b,a){return b!==a&&b.contains(a)},e.type=a,e.isFunction=c,e.isWindow=h,e.isArray=r,e.isPlainObject=p,e.isEmptyObject=function(b){for(var a in b)return!1;return!0},e.inArray=function(b,a,d){return t.indexOf.call(a,b,d)},e.camelCase=M,e.trim=function(b){return null==b?"":String.prototype.trim.call(b)},e.uuid=0,e.support={},e.expr={},e.map=function(b,a){var d,f=[],c;if(s(b))for(c=0;c<b.length;c++)d=a(b[c],c),null!=d&&f.push(d);else for(c in b)d=a(b[c],c),null!=d&&f.push(d);return 0<
f.length?e.fn.concat.apply([],f):f},e.each=function(b,a){var d;if(s(b))for(d=0;d<b.length&&!1!==a.call(b[d],d,b[d]);d++);else for(d in b)if(!1===a.call(b[d],d,b[d]))break;return b},e.grep=function(b,a){return f.call(b,a)},window.JSON&&(e.parseJSON=JSON.parse),e.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b,a){Q["[object "+a+"]"]=a.toLowerCase()}),e.fn={forEach:t.forEach,reduce:t.reduce,push:t.push,sort:t.sort,indexOf:t.indexOf,concat:t.concat,map:function(b){return e(e.map(this,
function(a,d){return b.call(a,d,a)}))},slice:function(){return e(d.apply(this,arguments))},ready:function(b){return X.test(l.readyState)&&l.body?b(e):l.addEventListener("DOMContentLoaded",function(){b(e)},!1),this},get:function(b){return b===v?d.call(this):this[0<=b?b:b+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(b){return t.every.call(this,
function(a,d){return!1!==b.call(a,d,a)}),this},filter:function(b){return c(b)?this.not(this.not(b)):e(f.call(this,function(a){return x.matches(a,b)}))},add:function(b,a){return e(N(this.concat(e(b,a))))},is:function(b){return 0<this.length&&x.matches(this[0],b)},not:function(b){var a=[];if(c(b)&&b.call!==v)this.each(function(d){b.call(this,d)||a.push(this)});else{var f="string"==typeof b?this.filter(b):s(b)&&c(b.item)?d.call(b):e(b);this.forEach(function(b){0>f.indexOf(b)&&a.push(b)})}return e(a)},
has:function(b){return this.filter(function(){return k(b)?e.contains(this,b):e(this).find(b).size()})},eq:function(b){return-1===b?this.slice(b):this.slice(b,+b+1)},first:function(){var b=this[0];return b&&!k(b)?b:e(b)},last:function(){var b=this[this.length-1];return b&&!k(b)?b:e(b)},find:function(b){var a,d=this;return"object"==typeof b?a=e(b).filter(function(){var b=this;return t.some.call(d,function(a){return e.contains(a,b)})}):1==this.length?a=e(x.qsa(this[0],b)):a=this.map(function(){return x.qsa(this,
b)}),a},closest:function(b,a){var d=this[0],f=!1;for("object"==typeof b&&(f=e(b));d&&!(f?0<=f.indexOf(d):x.matches(d,b));)d=d!==a&&!g(d)&&d.parentNode;return e(d)},parents:function(b){for(var a=[],d=this;0<d.length;)d=e.map(d,function(b){if((b=b.parentNode)&&!g(b)&&0>a.indexOf(b))return a.push(b),b});return z(a,b)},parent:function(b){return z(N(this.pluck("parentNode")),b)},children:function(b){return z(this.map(function(){return F(this)}),b)},contents:function(){return this.map(function(){return d.call(this.childNodes)})},
siblings:function(b){return z(this.map(function(b,a){return f.call(F(a.parentNode),function(b){return b!==a})}),b)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(b){return e.map(this,function(a){return a[b]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display="");if("none"==getComputedStyle(this,"").getPropertyValue("display")){var b=this.style,a;a=this.nodeName;var d,f;a=(K[a]||(d=l.createElement(a),l.body.appendChild(d),
f=getComputedStyle(d,"").getPropertyValue("display"),d.parentNode.removeChild(d),"none"==f&&(f="block"),K[a]=f),K[a]);b.display=a}})},replaceWith:function(b){return this.before(b).remove()},wrap:function(b){var a=c(b);if(this[0]&&!a)var d=e(b).get(0),f=d.parentNode||1<this.length;return this.each(function(c){e(this).wrapAll(a?b.call(this,c):f?d.cloneNode(!0):d)})},wrapAll:function(b){if(this[0]){e(this[0]).before(b=e(b));for(var a;(a=b.children()).length;)b=a.first();e(b).append(this)}return this},
wrapInner:function(b){var a=c(b);return this.each(function(d){var f=e(this),c=f.contents();d=a?b.call(this,d):b;c.length?c.wrapAll(d):f.append(d)})},unwrap:function(){return this.parent().each(function(){e(this).replaceWith(e(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(b){return this.each(function(){var a=e(this);(b===v?"none"==a.css("display"):b)?a.show():a.hide()})},prev:function(b){return e(this.pluck("previousElementSibling")).filter(b||
"*")},next:function(b){return e(this.pluck("nextElementSibling")).filter(b||"*")},html:function(b){return 0===arguments.length?0<this.length?this[0].innerHTML:null:this.each(function(a){var d=this.innerHTML;e(this).empty().append(A(this,b,a,d))})},text:function(b){return 0===arguments.length?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=b===v?"":""+b})},attr:function(b,a){var d;return"string"==typeof b&&a===v?0==this.length||1!==this[0].nodeType?v:"value"==b&&"INPUT"==
this[0].nodeName?this.val():!(d=this[0].getAttribute(b))&&b in this[0]?this[0][b]:d:this.each(function(d){if(1===this.nodeType)if(k(b))for(n in b){d=n;var f=b[n];null==f?this.removeAttribute(d):this.setAttribute(d,f)}else d=A(this,a,d,this.getAttribute(b)),null==d?this.removeAttribute(b):this.setAttribute(b,d)})},removeAttr:function(b){return this.each(function(){1===this.nodeType&&this.removeAttribute(b)})},prop:function(b,a){return b=Z[b]||b,a===v?this[0]&&this[0][b]:this.each(function(d){this[b]=
A(this,a,d,this[b])})},data:function(b,a){var d=this.attr("data-"+b.replace(U,"-$1").toLowerCase(),a);return null!==d?G(d):v},val:function(b){return 0===arguments.length?this[0]&&(this[0].multiple?e(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(a){this.value=A(this,b,a,this.value)})},offset:function(b){if(b)return this.each(function(a){var d=e(this);a=A(this,b,a,d.offset());var f=d.offsetParent().offset();a={top:a.top-f.top,left:a.left-
f.left};"static"==d.css("position")&&(a.position="relative");d.css(a)});if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:Math.round(a.width),height:Math.round(a.height)}},css:function(b,d){if(2>arguments.length){var f=this[0],c=getComputedStyle(f,"");if(!f)return;if("string"==typeof b)return f.style[M(b)]||c.getPropertyValue(b);if(r(b)){var t={};return e.each(r(b)?b:[b],function(b,a){t[a]=f.style[M(a)]||c.getPropertyValue(a)}),
t}}var l="";if("string"==a(b))d||0===d?l=w(b)+":"+E(b,d):this.each(function(){this.style.removeProperty(w(b))});else for(n in b)b[n]||0===b[n]?l+=w(n)+":"+E(n,b[n])+";":this.each(function(){this.style.removeProperty(w(n))});return this.each(function(){this.style.cssText+=";"+l})},index:function(b){return b?this.indexOf(e(b)[0]):this.parent().children().indexOf(this[0])},hasClass:function(b){return b?t.some.call(this,function(b){return this.test(u(b))},y(b)):!1},addClass:function(b){return b?this.each(function(a){B=
[];var d=u(this);A(this,b,a,d).split(/\s+/g).forEach(function(b){e(this).hasClass(b)||B.push(b)},this);B.length&&u(this,d+(d?" ":"")+B.join(" "))}):this},removeClass:function(b){return this.each(function(a){if(b===v)return u(this,"");B=u(this);A(this,b,a,B).split(/\s+/g).forEach(function(b){B=B.replace(y(b)," ")});u(this,B.trim())})},toggleClass:function(b,a){return b?this.each(function(d){var f=e(this);A(this,b,d,u(this)).split(/\s+/g).forEach(function(b){(a===v?!f.hasClass(b):a)?f.addClass(b):f.removeClass(b)})}):
this},scrollTop:function(b){if(this.length){var a="scrollTop"in this[0];return b===v?a?this[0].scrollTop:this[0].pageYOffset:this.each(a?function(){this.scrollTop=b}:function(){this.scrollTo(this.scrollX,b)})}},scrollLeft:function(b){if(this.length){var a="scrollLeft"in this[0];return b===v?a?this[0].scrollLeft:this[0].pageXOffset:this.each(a?function(){this.scrollLeft=b}:function(){this.scrollTo(b,this.scrollY)})}},position:function(){if(this.length){var b=this[0],a=this.offsetParent(),d=this.offset(),
f=P.test(a[0].nodeName)?{top:0,left:0}:a.offset();return d.top-=parseFloat(e(b).css("margin-top"))||0,d.left-=parseFloat(e(b).css("margin-left"))||0,f.top+=parseFloat(e(a[0]).css("border-top-width"))||0,f.left+=parseFloat(e(a[0]).css("border-left-width"))||0,{top:d.top-f.top,left:d.left-f.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||l.body;a&&!P.test(a.nodeName)&&"static"==e(a).css("position");)a=a.offsetParent;return a})}},e.fn.detach=e.fn.remove,["width",
"height"].forEach(function(a){var d=a.replace(/./,function(a){return a[0].toUpperCase()});e.fn[a]=function(f){var c,l=this[0];return f===v?h(l)?l["inner"+d]:g(l)?l.documentElement["scroll"+d]:(c=this.offset())&&c[a]:this.each(function(d){l=e(this);l.css(a,A(this,f,d,l[a]()))})}}),["after","prepend","before","append"].forEach(function(b,d){var f=d%2;e.fn[b]=function(){var b,c=e.map(arguments,function(d){return b=a(d),"object"==b||"array"==b||null==d?d:x.fragment(d)}),l,t=1<this.length;return 1>c.length?
this:this.each(function(a,b){l=f?b:b.parentNode;b=0==d?b.nextSibling:1==d?b.firstChild:2==d?b:null;c.forEach(function(a){if(t)a=a.cloneNode(!0);else if(!l)return e(a).remove();H(l.insertBefore(a,b),function(a){null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src||window.eval.call(window,a.innerHTML)})})})};e.fn[f?b+"To":"insert"+(d?"Before":"After")]=function(a){return e(a)[b](this),this}}),x.Z.prototype=e.fn,x.uniq=N,x.deserializeValue=G,e.zepto=x,e}();
window.Zepto=Zepto;void 0===window.$&&(window.$=Zepto);
(function(a){function c(a){return a._zid||(a._zid=w++)}function h(a,d,f,l){d=g(d);if(d.ns)var e=RegExp("(?:^| )"+d.ns.replace(" "," .* ?")+"(?: |$)");return(z[c(a)]||[]).filter(function(a){return a&&(!d.e||a.e==d.e)&&(!d.ns||e.test(a.ns))&&(!f||c(a.fn)===c(f))&&(!l||a.sel==l)})}function g(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function k(a){return H[a]||u&&G[a]||a}function p(e,d,f,l,h,I,p){var m=c(e),q=z[m]||(z[m]=[]);d.split(/\s/).forEach(function(d){if("ready"==d)return a(document).ready(f);
var c=g(d);c.fn=f;c.sel=h;c.e in H&&(f=function(d){var f=d.relatedTarget;if(!f||f!==this&&!a.contains(this,f))return c.fn.apply(this,arguments)});var m=(c.del=I)||f;c.proxy=function(a){a=s(a);if(!a.isImmediatePropagationStopped()){a.data=l;var d=m.apply(e,a._args==y?[a]:[a].concat(a._args));return!1===d&&(a.preventDefault(),a.stopPropagation()),d}};c.i=q.length;q.push(c);"addEventListener"in e&&e.addEventListener(k(c.e),c.proxy,c.del&&!u&&c.e in G||!!p)})}function r(a,d,f,l,e){var g=c(a);(d||"").split(/\s/).forEach(function(d){h(a,
d,f,l).forEach(function(d){delete z[g][d.i];"removeEventListener"in a&&a.removeEventListener(k(d.e),d.proxy,d.del&&!u&&d.e in G||!!e)})})}function s(c,d){if(d||!c.isDefaultPrevented)if(d||(d=c),a.each(B,function(a,l){var e=d[a];c[a]=function(){return this[l]=v,e&&e.apply(d,arguments)};c[l]=n}),d.defaultPrevented!==y?d.defaultPrevented:"returnValue"in d?!1===d.returnValue:d.getPreventDefault&&d.getPreventDefault())c.isDefaultPrevented=v;return c}function C(a){var d,f={originalEvent:a};for(d in a)!e.test(d)&&
a[d]!==y&&(f[d]=a[d]);return s(f,a)}var w=1,y,E=Array.prototype.slice,F=a.isFunction,m=function(a){return"string"==typeof a},z={},A={},u="onfocusin"in window,G={focus:"focusin",blur:"focusout"},H={mouseenter:"mouseover",mouseleave:"mouseout"};A.click=A.mousedown=A.mouseup=A.mousemove="MouseEvents";a.event={add:p,remove:r};a.proxy=function(e,d){if(F(e)){var f=function(){return e.apply(d,arguments)};return f._zid=c(e),f}if(m(d))return a.proxy(e[d],e);throw new TypeError("expected function");};a.fn.bind=
function(a,d,f){return this.on(a,d,f)};a.fn.unbind=function(a,d){return this.off(a,d)};a.fn.one=function(a,d,f,c){return this.on(a,d,f,c,1)};var v=function(){return!0},n=function(){return!1},e=/^([A-Z]|returnValue$|layer[XY]$)/,B={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,d,f){return this.on(d,a,f)};a.fn.undelegate=function(a,d,f){return this.off(d,a,f)};a.fn.live=function(c,d){return a(document.body).delegate(this.selector,
c,d),this};a.fn.die=function(c,d){return a(document.body).undelegate(this.selector,c,d),this};a.fn.on=function(c,d,f,l,e){var g,h,k=this;if(c&&!m(c))return a.each(c,function(a,c){k.on(a,d,f,c,e)}),k;!m(d)&&!F(l)&&!1!==l&&(l=f,f=d,d=y);if(F(f)||!1===f)l=f,f=y;return!1===l&&(l=n),k.each(function(k,m){e&&(g=function(a){return r(m,a.type,l),l.apply(this,arguments)});d&&(h=function(f){var c,e=a(f.target).closest(d,m).get(0);if(e&&e!==m)return c=a.extend(C(f),{currentTarget:e,liveFired:m}),(g||l).apply(e,
[c].concat(E.call(arguments,1)))});p(m,c,l,f,d,h||g)})};a.fn.off=function(c,d,f){var e=this;return c&&!m(c)?(a.each(c,function(a,f){e.off(a,d,f)}),e):(!m(d)&&!F(f)&&!1!==f&&(f=d,d=y),!1===f&&(f=n),e.each(function(){r(this,c,f,d)}))};a.fn.trigger=function(c,d){return c=m(c)||a.isPlainObject(c)?a.Event(c):s(c),c._args=d,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(c):a(this).triggerHandler(c,d)})};a.fn.triggerHandler=function(c,d){var f,e;return this.each(function(g,k){f=C(m(c)?a.Event(c):
c);f._args=d;f.target=k;a.each(h(k,c.type||c),function(a,d){e=d.proxy(f);if(f.isImmediatePropagationStopped())return!1})}),e};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(c){a.fn[c]=function(a){return a?this.bind(c,a):this.trigger(c)}});["focus","blur"].forEach(function(c){a.fn[c]=function(a){return a?this.bind(c,a):this.each(function(){try{this[c]()}catch(a){}}),
this}});a.Event=function(a,d){m(a)||(d=a,a=d.type);var c=document.createEvent(A[a]||"Events"),e=!0;if(d)for(var g in d)"bubbles"==g?e=!!d[g]:c[g]=d[g];return c.initEvent(a,e,!0),s(c)}})(Zepto);
(function(a){function c(d,c,e,g){if(d.global)return d=c||z,e=a.Event(e),a(d).trigger(e,g),!e.isDefaultPrevented()}function h(d){d.global&&0===a.active++&&c(d,null,"ajaxStart")}function g(a,f){var e=f.context;if(!1===f.beforeSend.call(e,a,f)||!1===c(f,e,"ajaxBeforeSend",[a,f]))return!1;c(f,e,"ajaxSend",[a,f])}function k(a,f,e,g){var h=e.context;e.success.call(h,a,"success",f);g&&g.resolveWith(h,[a,"success",f]);c(e,h,"ajaxSuccess",[f,e,a]);r("success",f,e)}function p(a,f,e,g,h){var k=g.context;g.error.call(k,
e,f,a);h&&h.rejectWith(k,[e,f,a]);c(g,k,"ajaxError",[e,g,a||f]);r(f,e,g)}function r(d,f,e){var g=e.context;e.complete.call(g,f,d);c(e,g,"ajaxComplete",[f,e]);e.global&&!--a.active&&c(e,null,"ajaxStop")}function s(){}function C(a){return a&&(a=a.split(";",2)[0]),a&&(a==e?"html":a==n?"json":H.test(a)?"script":v.test(a)&&"xml")||"text"}function w(a,c){return""==c?a:(a+"&"+c).replace(/[&?]{1,2}/,"?")}function y(d){d.processData&&d.data&&"string"!=a.type(d.data)&&(d.data=a.param(d.data,d.traditional));
d.data&&(!d.type||"GET"==d.type.toUpperCase())&&(d.url=w(d.url,d.data),d.data=void 0)}function E(d,c,e,g){var h=!a.isFunction(c);return{url:d,data:h?c:void 0,success:h?a.isFunction(e)?e:void 0:c,dataType:h?g||e:e}}function F(d,c,e,g){var h,k=a.isArray(c),m=a.isPlainObject(c);a.each(c,function(c,f){h=a.type(f);g&&(c=e?g:g+"["+(m||"object"==h||"array"==h?c:"")+"]");!g&&k?d.add(f.name,f.value):"array"==h||!e&&"object"==h?F(d,f,e,c):d.add(c,f)})}var m=0,z=window.document,A,u,G=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
H=/^(?:text|application)\/javascript/i,v=/^(?:text|application)\/xml/i,n="application/json",e="text/html",B=/^\s*$/;a.active=0;a.ajaxJSONP=function(d,c){if("type"in d){var e=d.jsonpCallback,h=(a.isFunction(e)?e():e)||"jsonp"+ ++m,n=z.createElement("script"),s=window[h],r,q=function(d){a(n).triggerHandler("error",d||"abort")},t={abort:q},u;return c&&c.promise(t),a(n).on("load error",function(e,g){clearTimeout(u);a(n).off().remove();"error"!=e.type&&r?k(r[0],t,d,c):p(null,g||"error",t,d,c);window[h]=
s;r&&a.isFunction(s)&&s(r[0]);s=r=void 0}),!1===g(t,d)?(q("abort"),t):(window[h]=function(){r=arguments},n.src=d.url.replace(/=\?/,"="+h),z.head.appendChild(n),0<d.timeout&&(u=setTimeout(function(){q("timeout")},d.timeout)),t)}return a.ajax(d)};a.ajaxSettings={type:"GET",beforeSend:s,success:s,error:s,complete:s,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:n,xml:"application/xml, text/xml",
html:e,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};a.ajax=function(d){var c=a.extend({},d||{}),e=a.Deferred&&a.Deferred();for(A in a.ajaxSettings)void 0===c[A]&&(c[A]=a.ajaxSettings[A]);h(c);c.crossDomain||(c.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(c.url)&&RegExp.$2!=window.location.host);c.url||(c.url=window.location.toString());y(c);!1===c.cache&&(c.url=w(c.url,"_="+Date.now()));var m=c.dataType;d=/=\?/.test(c.url);if("jsonp"==m||d)return d||(c.url=w(c.url,c.jsonp?c.jsonp+
"=?":!1===c.jsonp?"":"callback=?")),a.ajaxJSONP(c,e);d=c.accepts[m];var n={},r=function(a,c){n[a.toLowerCase()]=[a,c]},t=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:window.location.protocol,q=c.xhr(),v=q.setRequestHeader,z;e&&e.promise(q);c.crossDomain||r("X-Requested-With","XMLHttpRequest");r("Accept",d||"*/*");if(d=c.mimeType||d)-1<d.indexOf(",")&&(d=d.split(",",2)[0]),q.overrideMimeType&&q.overrideMimeType(d);(c.contentType||!1!==c.contentType&&c.data&&"GET"!=c.type.toUpperCase())&&r("Content-Type",
c.contentType||"application/x-www-form-urlencoded");if(c.headers)for(u in c.headers)r(u,c.headers[u]);q.setRequestHeader=r;q.onreadystatechange=function(){if(4==q.readyState){q.onreadystatechange=s;clearTimeout(z);var d,g=!1;if(200<=q.status&&300>q.status||304==q.status||0==q.status&&"file:"==t){m=m||C(c.mimeType||q.getResponseHeader("content-type"));d=q.responseText;try{"script"==m?(0,eval)(d):"xml"==m?d=q.responseXML:"json"==m&&(d=B.test(d)?null:a.parseJSON(d))}catch(h){g=h}g?p(g,"parsererror",
q,c,e):k(d,q,c,e)}else p(q.statusText||null,q.status?"error":"abort",q,c,e)}};if(!1===g(q,c))return q.abort(),p(null,"abort",q,c,e),q;if(c.xhrFields)for(u in c.xhrFields)q[u]=c.xhrFields[u];q.open(c.type,c.url,"async"in c?c.async:!0,c.username,c.password);for(u in n)v.apply(q,n[u]);return 0<c.timeout&&(z=setTimeout(function(){q.onreadystatechange=s;q.abort();p(null,"timeout",q,c,e)},c.timeout)),q.send(c.data?c.data:null),q};a.get=function(d,c,e,g){return a.ajax(E.apply(null,arguments))};a.post=function(d,
c,e,g){var h=E.apply(null,arguments);return h.type="POST",a.ajax(h)};a.getJSON=function(d,c,e){var g=E.apply(null,arguments);return g.dataType="json",a.ajax(g)};a.fn.load=function(c,e,g){if(!this.length)return this;var h=this,k=c.split(/\s/),m;c=E(c,e,g);var n=c.success;return 1<k.length&&(c.url=k[0],m=k[1]),c.success=function(c){h.html(m?a("<div>").html(c.replace(G,"")).find(m):c);n&&n.apply(h,arguments)},a.ajax(c),this};var t=encodeURIComponent;a.param=function(a,c){var e=[];return e.add=function(a,
c){this.push(t(a)+"="+t(c))},F(e,a,c),e.join("&").replace(/%20/g,"+")}})(Zepto);
(function(a){a.fn.serializeArray=function(){var c=[],h;return a([].slice.call(this.get(0).elements)).each(function(){h=a(this);var g=h.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=g&&"reset"!=g&&"button"!=g&&("radio"!=g&&"checkbox"!=g||this.checked)&&c.push({name:h.attr("name"),value:h.val()})}),c};a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(h){a.push(encodeURIComponent(h.name)+"="+encodeURIComponent(h.value))}),a.join("&")};
a.fn.submit=function(c){c?this.bind("submit",c):this.length&&(c=a.Event("submit"),this.eq(0).trigger(c),c.isDefaultPrevented()||this.get(0).submit());return this}})(Zepto);(function(a){"__proto__"in{}||a.extend(a.zepto,{Z:function(c,h){return c=c||[],a.extend(c,a.fn),c.selector=h||"",c.__Z=!0,c},isZ:function(c){return"array"===a.type(c)&&"__Z"in c}});try{getComputedStyle(void 0)}catch(c){var h=getComputedStyle;window.getComputedStyle=function(a){try{return h(a)}catch(c){return null}}}})(Zepto);
