/**
 * CIP.js, NatMus.js, qwest, underscore.js
 *
 * https://github.com/NationalMuseumofDenmark
 */
var qwest=function(){var a=window,f=null,g=0,h=[],q=function(){return a.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},s=""===q().responseType,u=function(p,z,t,y,E){t=t||null;y=y||{};var F=!1,n=q(),B=void 0===y.async?!0:!!y.async,A=!!y.cache,w=y.type?y.type.toLowerCase():"json",G=y.user||"",I=y.password||"",v={"X-Requested-With":"XMLHttpRequest"},l="",d,C,k=[],c=[],e=[],r,K,H,D,J={success:function(c){return B?k.push(c):K&&c.apply(n,[r]),J},error:function(e){return B?c.push(e):
H&&e.apply(n,[r]),J},complete:function(c){return B?e.push(c):c.apply(n),J}},m={success:function(c){return h[h.length-1].success.push(c),m},error:function(c){return h[h.length-1].error.push(c),m},complete:function(c){return h[h.length-1].complete.push(c),m}},L=function(){var d,f,q;--g;if(h.length){f=h.shift();q=u(f.method,f.url,f.data,f.options,f.before);for(d=0;D=f.success[d];++d)q.success(D);for(d=0;D=f.error[d];++d)q.error(D);for(d=0;D=f.complete[d];++d)q.complete(D)}try{if(200!=n.status)throw n.status+
" ("+n.statusText+")";if("text"==w||"html"==w)r=n.responseText;else if(F&&void 0!==n.response)r=n.response;else switch(w){case "json":try{a.JSON?r=a.JSON.parse(n.responseText):r=eval("("+n.responseText+")")}catch(m){throw"Error while parsing JSON body";}break;case "js":r=eval(n.responseText);break;case "xml":if(!n.responseXML||n.responseXML.parseError&&n.responseXML.parseError.errorCode&&n.responseXML.parseError.reason)throw"Error while parsing XML body";r=n.responseXML;break;default:throw"Unsupported "+
w+" type";}K=!0;if(B)for(d=0;D=k[d];++d)D.apply(n,[r])}catch(p){if(H=!0,r="Request to '"+z+"' aborted: "+p,B)for(d=0;D=c[d];++d)D.apply(n,[r])}if(B)for(d=0;D=e[d];++d)D.apply(n)};if(f&&g==f)return h.push({method:p,url:z,data:t,options:y,before:E,success:[],error:[],complete:[]}),m;++g;if(a.ArrayBuffer&&(t instanceof ArrayBuffer||t instanceof Blob||t instanceof Document||t instanceof FormData))"GET"==p&&(t=null);else{y=[];C=encodeURIComponent;for(d in t)y.push(C(d)+(t[d].pop?"[]":"")+"="+C(t[d]));
t=y.join("&");C=!0}"GET"==p&&(l+=t);A||(l&&(l+="&"),l+="t="+Date.now());l&&(z+=(/\?/.test(z)?"&":"?")+l);n.open(p,z,B,G,I);if(w&&s)try{n.responseType=w,F=n.responseType==w}catch(P){}s?n.onload=L:n.onreadystatechange=function(){4==n.readyState&&L()};C&&"POST"==p&&(v["Content-Type"]="application/x-www-form-urlencoded");v.Accept={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}[w];for(d in v)n.setRequestHeader(d,
v[d]);return E&&E.apply(n),n.send("POST"==p?t:null),J};return{get:function(a,f,h,g){return u("GET",a,f,h,g)},post:function(a,f,h,g){return u("POST",a,f,h,g)},xhr2:s,limit:function(a){f=a}}}();"undefined"==typeof window&&(window={});window.console=window.console||{log:function(){},error:function(){}};function assert(a,f){if(!a)throw f||"Assertion failed.";}"undefined"!=typeof exports?exports.assert=assert:window.cip_common={assert:assert};"undefined"!=typeof require&&(cip_table=require("./cip-table.js"),cip_common=require("./cip-common.js"));
function CIPCatalog(a,f){this.cip=a;for(var g in f)this[g]=f[g];void 0===this.alias&&(this.alias=a.config.catalog_aliases[this.name]);this.get_tables=function(f){cip_common.assert(this.cip.is_connected());var g=[],s=this;this.cip.ciprequest("metadata/gettables/"+a.config.constants.catch_all_alias,{catalogname:this.name},function(a,p){for(var z=0;z<a.tables.length;z++)g.push(new cip_table.CIPTable(this,s,a.tables[z]));f(g)})};this.get_categories=function(a,f,g){cip_common.assert(this.cip.is_connected());
this.cip.ciprequest("metadata/getcategories/"+this.alias+"/categories",{categoryid:a,levels:f},function(a,f){g(a)})}}"undefined"!=typeof exports?exports.CIPCatalog=CIPCatalog:window.cip_catalog={CIPCatalog:CIPCatalog};"undefined"!=typeof require&&(cip_common=require("./cip-common.js"));
function CIPTable(a,f,g){this.cip=a;this.catalog=f;this.name=g;this.layout=null;this.get_layout=function(a){cip_common.assert(this.cip.is_connected());var f=this.cip;this.cip.ciprequest("metadata/getlayout/"+this.cip.config.constants.layout_alias,{catalogname:this.catalog.name,table:this.name},function(g){this.layout=g;a(new CIPLayout(f,this.layout.fields))})};this.search=function(a,f){this.cip.search(this,a,f)};this.criteriasearch=function(a,f){this.cip.criteriasearch(this,a,f)}}
"undefined"!=typeof exports?exports.CIPTable=CIPTable:window.cip_table={CIPTable:CIPTable};function CIPAsset(a,f,g){this.cip=a;this.fields=f;this.get_field_value=function(a){};this.get_fields=function(){};this.get_asset_url=function(a){return void 0===a?this.cip.config.endpoint+"asset/download/"+g.alias+"/"+this.fields.id:this.cip.config.endpoint+"asset/download/"+g.alias+"/"+this.fields.id+"?version="+a};this.get_versions=function(a){this.cip.ciprequest("asset/getversions/"+g.alias+"/"+this.fields.id,{},function(f){a(f.versions)})};this.get_preview_url=function(){return this.cip.config.endpoint+
"preview/image/"+g.alias+"/"+this.fields.id};this.get_thumbnail_url=function(a){var f="",s="",u={},p=["size","maxsize","rotate","format","quality"];if(void 0!==a)for(var z in p)void 0!==a[p[z]]&&(u[p[z]]="format"!==p[z]?parseInt(a[p[z]]):a[p[z]]);for(var t in u)f+=s+t+"="+u[t],s="&";return this.cip.config.endpoint+"preview/thumbnail/"+g.alias+"/"+this.fields.id+"?"+f}}"undefined"!=typeof exports?exports.CIPAsset=CIPAsset:window.cip_asset={CIPAsset:CIPAsset};"undefined"!=typeof require&&(cip_asset=require("./cip-asset.js"));function CIPSearchResult(a,f,g){this.cip=a;this.total_rows=f.totalcount;this.collection_id=f.collection;this.catalog=g;this.get=function(a,f,s){var u=[];void 0===a&&(a=100);this.cip.ciprequest("metadata/getfieldvalues/web",{collection:this.collection_id,startindex:f,maxreturned:a},function(a){for(var f=0;f<a.items.length;f++)u.push(new cip_asset.CIPAsset(this,a.items[f],g));s(u)})}}
"undefined"!=typeof exports?exports.CIPSearchResult=CIPSearchResult:window.cip_searchresult={CIPSearchResult:CIPSearchResult};function CIPLayout(a,f){this.cip=a;this.fields=f;this.cache={};this.lookup_field=function(a){if(void 0!==this.cache[a])return this.cache[a];for(var h=0;h<f.length;h++)if(this.fields[h].key===a)return this.cache[a]=this.fields[h],this.fields[h]}}"undefined"!=typeof exports&&(exports.CIPLayout=CIPLayout);"undefined"!=typeof require&&(request=require("request"),cip_catalog=require("./cip-catalog.js"),cip_searchresult=require("./cip-searchresult.js"),cip_common=require("./cip-common.js"));
function CIPClient(a){this.config=a;this.jsessionid=null;this.DEBUG=!0;cip_common.assert(void 0!==a,"The CIPClient must be passed a config object.");cip_common.assert(void 0!==a.endpoint,"The config must have an endpoint property.");this.cache={catalogs:null};this.ciprequest=function(a,g,h,q,s){void 0===s&&(s=!1);var u={apiversion:4,serveraddress:"localhost"};if(void 0!==g)for(var p in g)u[p]=g[p];null===this.jsessionid&&"session/open"!==a&&console.error("ERROR: No jsessionid");g=null===this.jsessionid?
"":";jsessionid="+this.jsessionid;"function"===typeof h&&(h=h.bind(this));"function"===typeof q&&(q=q.bind(this));if("undefined"!=typeof require&&request)return request.post({url:this.config.endpoint+a+g,method:"POST",form:u},function(a,f,g){200!=f.statusCode?void 0===q?(console.log("No error function defined, calling success(null) :("),h(null)):q(f.body):h(JSON.parse(f.body))});if(qwest&&"object"===typeof qwest)return qwest.post(this.config.endpoint+a+g,u,{async:s},function(){}).success(h||function(g){console.log(["default success",
a,g])}).error(q||function(g){console.log(["default error",a,g])})};this.session_open=function(a,g,h,q){var s=this;this.ciprequest("session/open",{user:a,password:g},function(a){if(a.jsessionid)s.jsessionid=a.jsessionid,console.log("Connected to CIP: "+s.jsessionid),h(a);else{debugger;console.log("SessionID is missing!")}},function(a){q&&q(a)||console.error("Could not make request to CIP.")},!0)};this.session_close=function(){this.ciprequest("session/close",{})};this.is_connected=function(){return null!==
this.jsessionid};this.get_catalogs=function(a){cip_common.assert(this.is_connected());null!==this.cache.catalogs&&a(this.cache.catalogs);this.ciprequest("metadata/getcatalogs",{},function(g){this.cache.catalogs=[];for(var h=this.config.catalog_aliases,q=0;q<g.catalogs.length;q++)if(g.catalogs[q].name in h){var s=new cip_catalog.CIPCatalog(this,g.catalogs[q]);this.cache.catalogs.push(s)}a(this.cache.catalogs)})};this.search=function(a,g,h){cip_common.assert(this.is_connected());cip_common.assert(void 0!==
a.catalog.alias,"Catalog must have an alias.");cip_common.assert(void 0!==g&&""!==g,"Must define a query");this.ciprequest("metadata/search/"+a.catalog.alias,{quicksearchstring:g,table:a.name,collection:""},function(g){h(new cip_searchresult.CIPSearchResult(this,g,a.catalog))})};this.criteriasearch=function(a,g,h){cip_common.assert(this.is_connected());cip_common.assert(void 0!==a.catalog.alias,"Catalog must have an alias.");cip_common.assert(void 0!==g&&""!==g,"Must define a query");this.ciprequest("metadata/search/"+
a.catalog.alias,{querystring:g,table:a.name,collection:""},function(g){h(new cip_searchresult.CIPSearchResult(this,g,a.catalog))})};this.get_asset=function(a,g,h,q){cip_common.assert(this.is_connected());cip_common.assert(void 0!==a,"Catalog must have an alias.");cip_common.assert(void 0!==g,"The asset_id must have a value.");console.log("get_asset after assets ..");a=new CIPCatalog(this,{alias:a});!0===h?(console.log("fetch_metadata was true .."),h=new CIPTable(this,a,"AssetRecords"),console.log(a,
h),this.criteriasearch(h,"id == "+g,function(a){console.log("criteriasearch returned result ..",a);a.get(1,0,function(a){1!==a.length?(log.warning("The criteriasearch didn't return exactly one result. Check parameters."),q(null)):q(a[0])})})):(g=new CIPAsset(this,{id:g},a),q(g))};this.get_version=function(a){cip_common.assert("function"===typeof a,"The callback must be a function.");this.ciprequest("system/getversion",{},function(g){a(g.version)})}}
"undefined"!=typeof exports&&(exports.CIPClient=CIPClient);var Zepto=function(){function a(b){return null==b?String(b):Q[W.call(b)]||"object"}function f(b){return"function"==a(b)}function g(b){return null!=b&&b==b.window}function h(b){return null!=b&&b.nodeType==b.DOCUMENT_NODE}function q(b){return"object"==a(b)}function s(b){return q(b)&&!g(b)&&Object.getPrototypeOf(b)==Object.prototype}function u(b){return b instanceof Array}function p(b){return"number"==typeof b.length}function z(b){return e.call(b,function(b){return null!=b})}function t(b){return b.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function y(b){return b in H?H[b]:H[b]=RegExp("(^|\\s)"+b+"(\\s|$)")}function E(b,a){return"number"!=typeof a||D[t(b)]?a:a+"px"}function F(b){return"children"in b?c.call(b.children):d.map(b.childNodes,function(b){if(1==b.nodeType)return b})}function n(b,a,c){for(l in a)c&&(s(a[l])||u(a[l]))?(s(a[l])&&!s(b[l])&&(b[l]={}),u(a[l])&&!u(b[l])&&(b[l]=[]),n(b[l],a[l],c)):a[l]!==v&&(b[l]=a[l])}
function B(b,a){return null==a?d(b):d(b).filter(a)}function A(b,a,c,e){return f(a)?a.call(b,c,e):a}function w(b,a){var c=b.className,e=c&&c.baseVal!==v;if(a===v)return e?c.baseVal:c;e?c.baseVal=a:b.className=a}function G(b){var a;try{return b?"true"==b||("false"==b?!1:"null"==b?null:/^0/.test(b)||isNaN(a=Number(b))?/^[\[\{]/.test(b)?d.parseJSON(b):b:a):b}catch(c){return b}}function I(b,a){a(b);for(var c in b.childNodes)I(b.childNodes[c],a)}var v,l,d,C,k=[],c=k.slice,e=k.filter,r=window.document,K=
{},H={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},J=/^\s*<(\w+|!)[^>]*>/,m=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,L=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,P=/^(?:body|html)$/i,U=/([A-Z])/g,V="val css html text data width height offset".split(" "),O=r.createElement("table"),R=r.createElement("tr"),S={tr:r.createElement("tbody"),tbody:O,thead:O,tfoot:O,td:R,th:R,"*":r.createElement("div")},X=/complete|loaded|interactive/,Y=/^[\w-]*$/,
Q={},W=Q.toString,x={},M,N,T=r.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};return x.matches=function(b,a){if(!a||!b||1!==b.nodeType)return!1;var c=b.webkitMatchesSelector||b.mozMatchesSelector||b.oMatchesSelector||b.matchesSelector;if(c)return c.call(b,a);var e,
c=b.parentNode,d=!c;return d&&(c=T).appendChild(b),e=~x.qsa(c,a).indexOf(b),d&&T.removeChild(b),e},M=function(b){return b.replace(/-+(.)?/g,function(b,a){return a?a.toUpperCase():""})},N=function(b){return e.call(b,function(a,c){return b.indexOf(a)==c})},x.fragment=function(b,a,e){var k,f,g;return m.test(b)&&(k=d(r.createElement(RegExp.$1))),k||(b.replace&&(b=b.replace(L,"<$1></$2>")),a===v&&(a=J.test(b)&&RegExp.$1),a in S||(a="*"),g=S[a],g.innerHTML=""+b,k=d.each(c.call(g.childNodes),function(){g.removeChild(this)})),
s(e)&&(f=d(k),d.each(e,function(b,a){-1<V.indexOf(b)?f[b](a):f.attr(b,a)})),k},x.Z=function(b,a){return b=b||[],b.__proto__=d.fn,b.selector=a||"",b},x.isZ=function(b){return b instanceof x.Z},x.init=function(b,a){var c;if(!b)return x.Z();if("string"==typeof b)if(b=b.trim(),"<"==b[0]&&J.test(b))c=x.fragment(b,RegExp.$1,a),b=null;else{if(a!==v)return d(a).find(b);c=x.qsa(r,b)}else{if(f(b))return d(r).ready(b);if(x.isZ(b))return b;if(u(b))c=z(b);else if(q(b))c=[b],b=null;else if(J.test(b))c=x.fragment(b.trim(),
RegExp.$1,a),b=null;else{if(a!==v)return d(a).find(b);c=x.qsa(r,b)}}return x.Z(c,b)},d=function(b,a){return x.init(b,a)},d.extend=function(b){var a,e=c.call(arguments,1);return"boolean"==typeof b&&(a=b,b=e.shift()),e.forEach(function(c){n(b,c,a)}),b},x.qsa=function(b,a){var e,d="#"==a[0],k=!d&&"."==a[0],r=d||k?a.slice(1):a,f=Y.test(r);return h(b)&&f&&d?(e=b.getElementById(r))?[e]:[]:1!==b.nodeType&&9!==b.nodeType?[]:c.call(f&&!d?k?b.getElementsByClassName(r):b.getElementsByTagName(a):b.querySelectorAll(a))},
d.contains=function(b,a){return b!==a&&b.contains(a)},d.type=a,d.isFunction=f,d.isWindow=g,d.isArray=u,d.isPlainObject=s,d.isEmptyObject=function(b){for(var a in b)return!1;return!0},d.inArray=function(b,a,c){return k.indexOf.call(a,b,c)},d.camelCase=M,d.trim=function(b){return null==b?"":String.prototype.trim.call(b)},d.uuid=0,d.support={},d.expr={},d.map=function(b,a){var c,e=[],k;if(p(b))for(k=0;k<b.length;k++)c=a(b[k],k),null!=c&&e.push(c);else for(k in b)c=a(b[k],k),null!=c&&e.push(c);return 0<
e.length?d.fn.concat.apply([],e):e},d.each=function(b,a){var c;if(p(b))for(c=0;c<b.length&&!1!==a.call(b[c],c,b[c]);c++);else for(c in b)if(!1===a.call(b[c],c,b[c]))break;return b},d.grep=function(b,a){return e.call(b,a)},window.JSON&&(d.parseJSON=JSON.parse),d.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b,a){Q["[object "+a+"]"]=a.toLowerCase()}),d.fn={forEach:k.forEach,reduce:k.reduce,push:k.push,sort:k.sort,indexOf:k.indexOf,concat:k.concat,map:function(b){return d(d.map(this,
function(a,c){return b.call(a,c,a)}))},slice:function(){return d(c.apply(this,arguments))},ready:function(b){return X.test(r.readyState)&&r.body?b(d):r.addEventListener("DOMContentLoaded",function(){b(d)},!1),this},get:function(b){return b===v?c.call(this):this[0<=b?b:b+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(b){return k.every.call(this,
function(a,c){return!1!==b.call(a,c,a)}),this},filter:function(b){return f(b)?this.not(this.not(b)):d(e.call(this,function(a){return x.matches(a,b)}))},add:function(b,a){return d(N(this.concat(d(b,a))))},is:function(b){return 0<this.length&&x.matches(this[0],b)},not:function(b){var a=[];if(f(b)&&b.call!==v)this.each(function(c){b.call(this,c)||a.push(this)});else{var e="string"==typeof b?this.filter(b):p(b)&&f(b.item)?c.call(b):d(b);this.forEach(function(b){0>e.indexOf(b)&&a.push(b)})}return d(a)},
has:function(b){return this.filter(function(){return q(b)?d.contains(this,b):d(this).find(b).size()})},eq:function(b){return-1===b?this.slice(b):this.slice(b,+b+1)},first:function(){var b=this[0];return b&&!q(b)?b:d(b)},last:function(){var b=this[this.length-1];return b&&!q(b)?b:d(b)},find:function(b){var a,c=this;return"object"==typeof b?a=d(b).filter(function(){var b=this;return k.some.call(c,function(a){return d.contains(a,b)})}):1==this.length?a=d(x.qsa(this[0],b)):a=this.map(function(){return x.qsa(this,
b)}),a},closest:function(b,a){var c=this[0],e=!1;for("object"==typeof b&&(e=d(b));c&&!(e?0<=e.indexOf(c):x.matches(c,b));)c=c!==a&&!h(c)&&c.parentNode;return d(c)},parents:function(b){for(var a=[],c=this;0<c.length;)c=d.map(c,function(b){if((b=b.parentNode)&&!h(b)&&0>a.indexOf(b))return a.push(b),b});return B(a,b)},parent:function(b){return B(N(this.pluck("parentNode")),b)},children:function(b){return B(this.map(function(){return F(this)}),b)},contents:function(){return this.map(function(){return c.call(this.childNodes)})},
siblings:function(b){return B(this.map(function(b,a){return e.call(F(a.parentNode),function(b){return b!==a})}),b)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(b){return d.map(this,function(a){return a[b]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display="");if("none"==getComputedStyle(this,"").getPropertyValue("display")){var b=this.style,a;a=this.nodeName;var c,e;a=(K[a]||(c=r.createElement(a),r.body.appendChild(c),
e=getComputedStyle(c,"").getPropertyValue("display"),c.parentNode.removeChild(c),"none"==e&&(e="block"),K[a]=e),K[a]);b.display=a}})},replaceWith:function(b){return this.before(b).remove()},wrap:function(b){var a=f(b);if(this[0]&&!a)var c=d(b).get(0),e=c.parentNode||1<this.length;return this.each(function(k){d(this).wrapAll(a?b.call(this,k):e?c.cloneNode(!0):c)})},wrapAll:function(b){if(this[0]){d(this[0]).before(b=d(b));for(var a;(a=b.children()).length;)b=a.first();d(b).append(this)}return this},
wrapInner:function(b){var a=f(b);return this.each(function(c){var e=d(this),k=e.contents();c=a?b.call(this,c):b;k.length?k.wrapAll(c):e.append(c)})},unwrap:function(){return this.parent().each(function(){d(this).replaceWith(d(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(b){return this.each(function(){var a=d(this);(b===v?"none"==a.css("display"):b)?a.show():a.hide()})},prev:function(b){return d(this.pluck("previousElementSibling")).filter(b||
"*")},next:function(b){return d(this.pluck("nextElementSibling")).filter(b||"*")},html:function(b){return 0===arguments.length?0<this.length?this[0].innerHTML:null:this.each(function(a){var c=this.innerHTML;d(this).empty().append(A(this,b,a,c))})},text:function(b){return 0===arguments.length?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=b===v?"":""+b})},attr:function(b,a){var c;return"string"==typeof b&&a===v?0==this.length||1!==this[0].nodeType?v:"value"==b&&"INPUT"==
this[0].nodeName?this.val():!(c=this[0].getAttribute(b))&&b in this[0]?this[0][b]:c:this.each(function(c){if(1===this.nodeType)if(q(b))for(l in b){c=l;var e=b[l];null==e?this.removeAttribute(c):this.setAttribute(c,e)}else c=A(this,a,c,this.getAttribute(b)),null==c?this.removeAttribute(b):this.setAttribute(b,c)})},removeAttr:function(b){return this.each(function(){1===this.nodeType&&this.removeAttribute(b)})},prop:function(b,a){return b=Z[b]||b,a===v?this[0]&&this[0][b]:this.each(function(c){this[b]=
A(this,a,c,this[b])})},data:function(b,a){var c=this.attr("data-"+b.replace(U,"-$1").toLowerCase(),a);return null!==c?G(c):v},val:function(b){return 0===arguments.length?this[0]&&(this[0].multiple?d(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(a){this.value=A(this,b,a,this.value)})},offset:function(b){if(b)return this.each(function(a){var c=d(this);a=A(this,b,a,c.offset());var e=c.offsetParent().offset();a={top:a.top-e.top,left:a.left-
e.left};"static"==c.css("position")&&(a.position="relative");c.css(a)});if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:Math.round(a.width),height:Math.round(a.height)}},css:function(b,c){if(2>arguments.length){var e=this[0],k=getComputedStyle(e,"");if(!e)return;if("string"==typeof b)return e.style[M(b)]||k.getPropertyValue(b);if(u(b)){var r={};return d.each(u(b)?b:[b],function(b,a){r[a]=e.style[M(a)]||k.getPropertyValue(a)}),
r}}var f="";if("string"==a(b))c||0===c?f=t(b)+":"+E(b,c):this.each(function(){this.style.removeProperty(t(b))});else for(l in b)b[l]||0===b[l]?f+=t(l)+":"+E(l,b[l])+";":this.each(function(){this.style.removeProperty(t(l))});return this.each(function(){this.style.cssText+=";"+f})},index:function(b){return b?this.indexOf(d(b)[0]):this.parent().children().indexOf(this[0])},hasClass:function(b){return b?k.some.call(this,function(b){return this.test(w(b))},y(b)):!1},addClass:function(b){return b?this.each(function(a){C=
[];var c=w(this);A(this,b,a,c).split(/\s+/g).forEach(function(b){d(this).hasClass(b)||C.push(b)},this);C.length&&w(this,c+(c?" ":"")+C.join(" "))}):this},removeClass:function(b){return this.each(function(a){if(b===v)return w(this,"");C=w(this);A(this,b,a,C).split(/\s+/g).forEach(function(b){C=C.replace(y(b)," ")});w(this,C.trim())})},toggleClass:function(b,a){return b?this.each(function(c){var e=d(this);A(this,b,c,w(this)).split(/\s+/g).forEach(function(b){(a===v?!e.hasClass(b):a)?e.addClass(b):e.removeClass(b)})}):
this},scrollTop:function(b){if(this.length){var a="scrollTop"in this[0];return b===v?a?this[0].scrollTop:this[0].pageYOffset:this.each(a?function(){this.scrollTop=b}:function(){this.scrollTo(this.scrollX,b)})}},scrollLeft:function(b){if(this.length){var a="scrollLeft"in this[0];return b===v?a?this[0].scrollLeft:this[0].pageXOffset:this.each(a?function(){this.scrollLeft=b}:function(){this.scrollTo(b,this.scrollY)})}},position:function(){if(this.length){var b=this[0],a=this.offsetParent(),c=this.offset(),
e=P.test(a[0].nodeName)?{top:0,left:0}:a.offset();return c.top-=parseFloat(d(b).css("margin-top"))||0,c.left-=parseFloat(d(b).css("margin-left"))||0,e.top+=parseFloat(d(a[0]).css("border-top-width"))||0,e.left+=parseFloat(d(a[0]).css("border-left-width"))||0,{top:c.top-e.top,left:c.left-e.left}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent||r.body;b&&!P.test(b.nodeName)&&"static"==d(b).css("position");)b=b.offsetParent;return b})}},d.fn.detach=d.fn.remove,["width",
"height"].forEach(function(b){var a=b.replace(/./,function(b){return b[0].toUpperCase()});d.fn[b]=function(c){var e,k=this[0];return c===v?g(k)?k["inner"+a]:h(k)?k.documentElement["scroll"+a]:(e=this.offset())&&e[b]:this.each(function(a){k=d(this);k.css(b,A(this,c,a,k[b]()))})}}),["after","prepend","before","append"].forEach(function(b,c){var e=c%2;d.fn[b]=function(){var b,k=d.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:x.fragment(c)}),r,f=1<this.length;return 1>k.length?
this:this.each(function(b,a){r=e?a:a.parentNode;a=0==c?a.nextSibling:1==c?a.firstChild:2==c?a:null;k.forEach(function(b){if(f)b=b.cloneNode(!0);else if(!r)return d(b).remove();I(r.insertBefore(b,a),function(b){null==b.nodeName||"SCRIPT"!==b.nodeName.toUpperCase()||b.type&&"text/javascript"!==b.type||b.src||window.eval.call(window,b.innerHTML)})})})};d.fn[e?b+"To":"insert"+(c?"Before":"After")]=function(a){return d(a)[b](this),this}}),x.Z.prototype=d.fn,x.uniq=N,x.deserializeValue=G,d.zepto=x,d}();
window.Zepto=Zepto;void 0===window.$&&(window.$=Zepto);
(function(a){function f(a){return a._zid||(a._zid=t++)}function g(a,c,e,d){c=h(c);if(c.ns)var g=RegExp("(?:^| )"+c.ns.replace(" "," .* ?")+"(?: |$)");return(B[f(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||g.test(a.ns))&&(!e||f(a.fn)===f(e))&&(!d||a.sel==d)})}function h(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function q(a){return I[a]||w&&G[a]||a}function s(k,c,e,d,g,H,n){var l=f(k),m=B[l]||(B[l]=[]);c.split(/\s/).forEach(function(c){if("ready"==c)return a(document).ready(e);
var f=h(c);f.fn=e;f.sel=g;f.e in I&&(e=function(c){var e=c.relatedTarget;if(!e||e!==this&&!a.contains(this,e))return f.fn.apply(this,arguments)});var l=(f.del=H)||e;f.proxy=function(a){a=p(a);if(!a.isImmediatePropagationStopped()){a.data=d;var c=l.apply(k,a._args==y?[a]:[a].concat(a._args));return!1===c&&(a.preventDefault(),a.stopPropagation()),c}};f.i=m.length;m.push(f);"addEventListener"in k&&k.addEventListener(q(f.e),f.proxy,f.del&&!w&&f.e in G||!!n)})}function u(a,c,e,d,h){var H=f(a);(c||"").split(/\s/).forEach(function(c){g(a,
c,e,d).forEach(function(c){delete B[H][c.i];"removeEventListener"in a&&a.removeEventListener(q(c.e),c.proxy,c.del&&!w&&c.e in G||!!h)})})}function p(d,c){if(c||!d.isDefaultPrevented)if(c||(c=d),a.each(C,function(a,f){var g=c[a];d[a]=function(){return this[f]=v,g&&g.apply(c,arguments)};d[f]=l}),c.defaultPrevented!==y?c.defaultPrevented:"returnValue"in c?!1===c.returnValue:c.getPreventDefault&&c.getPreventDefault())d.isDefaultPrevented=v;return d}function z(a){var c,e={originalEvent:a};for(c in a)!d.test(c)&&
a[c]!==y&&(e[c]=a[c]);return p(e,a)}var t=1,y,E=Array.prototype.slice,F=a.isFunction,n=function(a){return"string"==typeof a},B={},A={},w="onfocusin"in window,G={focus:"focusin",blur:"focusout"},I={mouseenter:"mouseover",mouseleave:"mouseout"};A.click=A.mousedown=A.mouseup=A.mousemove="MouseEvents";a.event={add:s,remove:u};a.proxy=function(d,c){if(F(d)){var e=function(){return d.apply(c,arguments)};return e._zid=f(d),e}if(n(c))return a.proxy(d[c],d);throw new TypeError("expected function");};a.fn.bind=
function(a,c,e){return this.on(a,c,e)};a.fn.unbind=function(a,c){return this.off(a,c)};a.fn.one=function(a,c,e,d){return this.on(a,c,e,d,1)};var v=function(){return!0},l=function(){return!1},d=/^([A-Z]|returnValue$|layer[XY]$)/,C={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,c,e){return this.on(c,a,e)};a.fn.undelegate=function(a,c,e){return this.off(c,a,e)};a.fn.live=function(d,c){return a(document.body).delegate(this.selector,
d,c),this};a.fn.die=function(d,c){return a(document.body).undelegate(this.selector,d,c),this};a.fn.on=function(d,c,e,f,g){var h,q,p=this;if(d&&!n(d))return a.each(d,function(a,d){p.on(a,c,e,d,g)}),p;!n(c)&&!F(f)&&!1!==f&&(f=e,e=c,c=y);if(F(e)||!1===e)f=e,e=y;return!1===f&&(f=l),p.each(function(m,l){g&&(h=function(a){return u(l,a.type,f),f.apply(this,arguments)});c&&(q=function(e){var d,g=a(e.target).closest(c,l).get(0);if(g&&g!==l)return d=a.extend(z(e),{currentTarget:g,liveFired:l}),(h||f).apply(g,
[d].concat(E.call(arguments,1)))});s(l,d,f,e,c,q||h)})};a.fn.off=function(d,c,e){var f=this;return d&&!n(d)?(a.each(d,function(a,e){f.off(a,c,e)}),f):(!n(c)&&!F(e)&&!1!==e&&(e=c,c=y),!1===e&&(e=l),f.each(function(){u(this,d,e,c)}))};a.fn.trigger=function(d,c){return d=n(d)||a.isPlainObject(d)?a.Event(d):p(d),d._args=c,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(d):a(this).triggerHandler(d,c)})};a.fn.triggerHandler=function(d,c){var e,f;return this.each(function(h,l){e=z(n(d)?a.Event(d):
d);e._args=c;e.target=l;a.each(g(l,d.type||d),function(a,c){f=c.proxy(e);if(e.isImmediatePropagationStopped())return!1})}),f};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(d){a.fn[d]=function(a){return a?this.bind(d,a):this.trigger(d)}});["focus","blur"].forEach(function(d){a.fn[d]=function(a){return a?this.bind(d,a):this.each(function(){try{this[d]()}catch(a){}}),
this}});a.Event=function(a,c){n(a)||(c=a,a=c.type);var e=document.createEvent(A[a]||"Events"),d=!0;if(c)for(var f in c)"bubbles"==f?d=!!c[f]:e[f]=c[f];return e.initEvent(a,d,!0),p(e)}})(Zepto);
(function(a){function f(c,e,d,f){if(c.global)return c=e||B,d=a.Event(d),a(c).trigger(d,f),!d.isDefaultPrevented()}function g(c){c.global&&0===a.active++&&f(c,null,"ajaxStart")}function h(a,e){var d=e.context;if(!1===e.beforeSend.call(d,a,e)||!1===f(e,d,"ajaxBeforeSend",[a,e]))return!1;f(e,d,"ajaxSend",[a,e])}function q(a,e,d,g){var h=d.context;d.success.call(h,a,"success",e);g&&g.resolveWith(h,[a,"success",e]);f(d,h,"ajaxSuccess",[e,d,a]);u("success",e,d)}function s(a,e,d,g,h){var k=g.context;g.error.call(k,
d,e,a);h&&h.rejectWith(k,[d,e,a]);f(g,k,"ajaxError",[d,g,a||e]);u(e,d,g)}function u(c,e,d){var g=d.context;d.complete.call(g,e,c);f(d,g,"ajaxComplete",[e,d]);d.global&&!--a.active&&f(d,null,"ajaxStop")}function p(){}function z(a){return a&&(a=a.split(";",2)[0]),a&&(a==d?"html":a==l?"json":I.test(a)?"script":v.test(a)&&"xml")||"text"}function t(a,e){return""==e?a:(a+"&"+e).replace(/[&?]{1,2}/,"?")}function y(c){c.processData&&c.data&&"string"!=a.type(c.data)&&(c.data=a.param(c.data,c.traditional));
c.data&&(!c.type||"GET"==c.type.toUpperCase())&&(c.url=t(c.url,c.data),c.data=void 0)}function E(c,e,d,f){var g=!a.isFunction(e);return{url:c,data:g?e:void 0,success:g?a.isFunction(d)?d:void 0:e,dataType:g?f||d:d}}function F(c,e,d,f){var g,h=a.isArray(e),k=a.isPlainObject(e);a.each(e,function(e,l){g=a.type(l);f&&(e=d?f:f+"["+(k||"object"==g||"array"==g?e:"")+"]");!f&&h?c.add(l.name,l.value):"array"==g||!d&&"object"==g?F(c,l,d,e):c.add(e,l)})}var n=0,B=window.document,A,w,G=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
I=/^(?:text|application)\/javascript/i,v=/^(?:text|application)\/xml/i,l="application/json",d="text/html",C=/^\s*$/;a.active=0;a.ajaxJSONP=function(c,e){if("type"in c){var d=c.jsonpCallback,f=(a.isFunction(d)?d():d)||"jsonp"+ ++n,g=B.createElement("script"),k=window[f],l,m=function(c){a(g).triggerHandler("error",c||"abort")},p={abort:m},t;return e&&e.promise(p),a(g).on("load error",function(d,h){clearTimeout(t);a(g).off().remove();"error"!=d.type&&l?q(l[0],p,c,e):s(null,h||"error",p,c,e);window[f]=
k;l&&a.isFunction(k)&&k(l[0]);k=l=void 0}),!1===h(p,c)?(m("abort"),p):(window[f]=function(){l=arguments},g.src=c.url.replace(/=\?/,"="+f),B.head.appendChild(g),0<c.timeout&&(t=setTimeout(function(){m("timeout")},c.timeout)),p)}return a.ajax(c)};a.ajaxSettings={type:"GET",beforeSend:p,success:p,error:p,complete:p,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:l,xml:"application/xml, text/xml",
html:d,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};a.ajax=function(c){var e=a.extend({},c||{}),d=a.Deferred&&a.Deferred();for(A in a.ajaxSettings)void 0===e[A]&&(e[A]=a.ajaxSettings[A]);g(e);e.crossDomain||(e.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(e.url)&&RegExp.$2!=window.location.host);e.url||(e.url=window.location.toString());y(e);!1===e.cache&&(e.url=t(e.url,"_="+Date.now()));var f=e.dataType;c=/=\?/.test(e.url);if("jsonp"==f||c)return c||(e.url=t(e.url,e.jsonp?e.jsonp+
"=?":!1===e.jsonp?"":"callback=?")),a.ajaxJSONP(e,d);c=e.accepts[f];var k={},l=function(a,c){k[a.toLowerCase()]=[a,c]},n=/^([\w-]+:)\/\//.test(e.url)?RegExp.$1:window.location.protocol,m=e.xhr(),v=m.setRequestHeader,u;d&&d.promise(m);e.crossDomain||l("X-Requested-With","XMLHttpRequest");l("Accept",c||"*/*");if(c=e.mimeType||c)-1<c.indexOf(",")&&(c=c.split(",",2)[0]),m.overrideMimeType&&m.overrideMimeType(c);(e.contentType||!1!==e.contentType&&e.data&&"GET"!=e.type.toUpperCase())&&l("Content-Type",
e.contentType||"application/x-www-form-urlencoded");if(e.headers)for(w in e.headers)l(w,e.headers[w]);m.setRequestHeader=l;m.onreadystatechange=function(){if(4==m.readyState){m.onreadystatechange=p;clearTimeout(u);var c,g=!1;if(200<=m.status&&300>m.status||304==m.status||0==m.status&&"file:"==n){f=f||z(e.mimeType||m.getResponseHeader("content-type"));c=m.responseText;try{"script"==f?(0,eval)(c):"xml"==f?c=m.responseXML:"json"==f&&(c=C.test(c)?null:a.parseJSON(c))}catch(h){g=h}g?s(g,"parsererror",
m,e,d):q(c,m,e,d)}else s(m.statusText||null,m.status?"error":"abort",m,e,d)}};if(!1===h(m,e))return m.abort(),s(null,"abort",m,e,d),m;if(e.xhrFields)for(w in e.xhrFields)m[w]=e.xhrFields[w];m.open(e.type,e.url,"async"in e?e.async:!0,e.username,e.password);for(w in k)v.apply(m,k[w]);return 0<e.timeout&&(u=setTimeout(function(){m.onreadystatechange=p;m.abort();s(null,"timeout",m,e,d)},e.timeout)),m.send(e.data?e.data:null),m};a.get=function(c,d,f,g){return a.ajax(E.apply(null,arguments))};a.post=function(c,
d,f,g){var h=E.apply(null,arguments);return h.type="POST",a.ajax(h)};a.getJSON=function(c,d,f){var g=E.apply(null,arguments);return g.dataType="json",a.ajax(g)};a.fn.load=function(c,d,f){if(!this.length)return this;var g=this,h=c.split(/\s/),k;c=E(c,d,f);var l=c.success;return 1<h.length&&(c.url=h[0],k=h[1]),c.success=function(c){g.html(k?a("<div>").html(c.replace(G,"")).find(k):c);l&&l.apply(g,arguments)},a.ajax(c),this};var k=encodeURIComponent;a.param=function(a,d){var f=[];return f.add=function(a,
c){this.push(k(a)+"="+k(c))},F(f,a,d),f.join("&").replace(/%20/g,"+")}})(Zepto);
(function(a){a.fn.serializeArray=function(){var f=[],g;return a([].slice.call(this.get(0).elements)).each(function(){g=a(this);var h=g.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=h&&"reset"!=h&&"button"!=h&&("radio"!=h&&"checkbox"!=h||this.checked)&&f.push({name:g.attr("name"),value:g.val()})}),f};a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(g){a.push(encodeURIComponent(g.name)+"="+encodeURIComponent(g.value))}),a.join("&")};
a.fn.submit=function(f){f?this.bind("submit",f):this.length&&(f=a.Event("submit"),this.eq(0).trigger(f),f.isDefaultPrevented()||this.get(0).submit());return this}})(Zepto);(function(a){"__proto__"in{}||a.extend(a.zepto,{Z:function(f,g){return f=f||[],a.extend(f,a.fn),f.selector=g||"",f.__Z=!0,f},isZ:function(f){return"array"===a.type(f)&&"__Z"in f}});try{getComputedStyle(void 0)}catch(f){var g=getComputedStyle;window.getComputedStyle=function(a){try{return g(a)}catch(f){return null}}}})(Zepto);
